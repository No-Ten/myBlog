

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/myBlog/img/fluid.png">
  <link rel="icon" href="/myBlog/img/browserTitle.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Ten">
  <meta name="keywords" content="">
  
    <meta name="description" content="day06-整合阿里云oss和Excel导入分类讲师管理-上传讲师头像后端接口后端环境搭建搭建阿里云OSS项目环境在service模块下创建子模块service_oss 配置pom.xml 123456789101112131415&lt;dependencies&gt;        &lt;!-- 阿里云oss依赖 --&gt;        &lt;dependency&gt;">
<meta property="og:type" content="article">
<meta property="og:title" content="day06-整合阿里云oss和Excel导入分类">
<meta property="og:url" content="https://no-ten.github.io/day06-%E6%95%B4%E5%90%88%E9%98%BF%E9%87%8C%E4%BA%91oss%E5%92%8CExcel%E5%AF%BC%E5%85%A5%E5%88%86%E7%B1%BB/index.html">
<meta property="og:site_name" content="TBlog">
<meta property="og:description" content="day06-整合阿里云oss和Excel导入分类讲师管理-上传讲师头像后端接口后端环境搭建搭建阿里云OSS项目环境在service模块下创建子模块service_oss 配置pom.xml 123456789101112131415&lt;dependencies&gt;        &lt;!-- 阿里云oss依赖 --&gt;        &lt;dependency&gt;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://no-ten.github.io/myBlog/day06-%E6%95%B4%E5%90%88%E9%98%BF%E9%87%8C%E4%BA%91oss%E5%92%8CExcel%E5%AF%BC%E5%85%A5%E5%88%86%E7%B1%BB/07-nginx%E6%A6%82%E5%BF%B5%E5%9B%9E%E9%A1%BE.png">
<meta property="og:image" content="https://no-ten.github.io/myBlog/day06-%E6%95%B4%E5%90%88%E9%98%BF%E9%87%8C%E4%BA%91oss%E5%92%8CExcel%E5%AF%BC%E5%85%A5%E5%88%86%E7%B1%BB/image-20211224141522821.png">
<meta property="article:published_time" content="2021-12-24T03:00:24.335Z">
<meta property="article:modified_time" content="2022-01-06T16:40:56.867Z">
<meta property="article:author" content="Ten">
<meta property="article:tag" content="project">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://no-ten.github.io/myBlog/day06-%E6%95%B4%E5%90%88%E9%98%BF%E9%87%8C%E4%BA%91oss%E5%92%8CExcel%E5%AF%BC%E5%85%A5%E5%88%86%E7%B1%BB/07-nginx%E6%A6%82%E5%BF%B5%E5%9B%9E%E9%A1%BE.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>day06-整合阿里云oss和Excel导入分类 - TBlog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/myBlog/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/myBlog/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/myBlog/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"no-ten.github.io","root":"/myBlog/","version":"1.9.0","typing":{"enable":true,"typeSpeed":230,"cursorChar":"_","loop":true,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/myBlog/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/myBlog/js/utils.js" ></script>
  <script  src="/myBlog/js/color-schema.js" ></script>

  
<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/myBlog/atom.xml" title="TBlog" type="application/atom+xml">
</head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/myBlog/">
      <strong>TBlog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/myBlog/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/myBlog/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/myBlog/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/myBlog/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/myBlog/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/myBlog/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="day06-整合阿里云oss和Excel导入分类"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        Ten
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2021-12-24 11:00" pubdate>
          2021年12月24日上午11点00分 
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          24k 字
        
      </span>
    

    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">day06-整合阿里云oss和Excel导入分类</h1>
            
            <div class="markdown-body">
              
              <h1 id="day06-整合阿里云oss和Excel导入分类"><a href="#day06-整合阿里云oss和Excel导入分类" class="headerlink" title="day06-整合阿里云oss和Excel导入分类"></a>day06-整合阿里云oss和Excel导入分类</h1><h1 id="讲师管理-上传讲师头像后端接口"><a href="#讲师管理-上传讲师头像后端接口" class="headerlink" title="讲师管理-上传讲师头像后端接口"></a>讲师管理-上传讲师头像后端接口</h1><h2 id="后端环境搭建"><a href="#后端环境搭建" class="headerlink" title="后端环境搭建"></a>后端环境搭建</h2><h3 id="搭建阿里云OSS项目环境"><a href="#搭建阿里云OSS项目环境" class="headerlink" title="搭建阿里云OSS项目环境"></a>搭建阿里云OSS项目环境</h3><p>在service模块下创建子模块service_oss</p>
<p>配置pom.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br><br>        <span class="hljs-comment">&lt;!-- 阿里云oss依赖 --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.aliyun.oss<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>aliyun-sdk-oss<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>        <span class="hljs-comment">&lt;!-- 日期工具栏依赖 --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>joda-time<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>joda-time<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>配置application.properties</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment">#服务端口</span><br><span class="hljs-meta">server.port</span>=<span class="hljs-string">8002</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">#服务名</span><br><span class="hljs-meta">spring.application.name</span>=<span class="hljs-string">service-oss</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">#环境设置：dev、test、prod</span><br><span class="hljs-meta">spring.profiles.active</span>=<span class="hljs-string">dev</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">#阿里云 OSS</span><br><span class="hljs-comment">#不同的服务器，地址不同</span><br><span class="hljs-meta">aliyun.oss.file.endpoint</span>=<span class="hljs-string">your endpoint</span><br><span class="hljs-meta">aliyun.oss.file.keyid</span>=<span class="hljs-string">your accessKeyId</span><br><span class="hljs-meta">aliyun.oss.file.keysecret</span>=<span class="hljs-string">your accessKeySecret</span><br><span class="hljs-comment">#bucket可以在控制台创建，也可以使用java代码创建</span><br><span class="hljs-meta">aliyun.oss.file.bucketname</span>=<span class="hljs-string">guli-file</span><br></code></pre></td></tr></table></figure>

<p>创建启动类，启动项目，发现报了一个需要配置数据库的问题</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">***************************<br>APPLICATION FAILED TO START<br>***************************<br><br>Description:<br><br>Failed to configure a DataSource: <span class="hljs-string">&#x27;url&#x27;</span> attribute is not specified and no embedded datasource could be configured.<br><br>Reason: Failed to determine a suitable driver class<br><br><br>Action:<br><br>Consider the following:<br>	If you want an embedded database (H2, HSQL or Derby), please put it on the classpath.<br>	If you have database settings to be loaded from a particular profile you may need to activate it (no profiles are currently active).<br><br></code></pre></td></tr></table></figure>

<p>解决方案</p>
<p>一，在配置文件中加入数据库的配置（由于该模块只做上传功能，不需要加入）。</p>
<p>二，在启动类上加入@SpringBootApplication(exclude = DataSourceAutoConfiguration.class)这个便可，排除数据库自动装配的文件</p>
<h2 id="创建常量类"><a href="#创建常量类" class="headerlink" title="创建常量类"></a>创建常量类</h2><p>创建com.atguigu.oss.utils包，创建类ConstantPropertiesUtils</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 项目启动，spring接口，spring加载之后，执行接口一个方法</span><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConstantPropertiesUtils</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">InitializingBean</span> </span>&#123;<br>    <span class="hljs-comment">// 读取配置文件内容</span><br>    <span class="hljs-meta">@Value(&quot;$&#123;aliyun.oss.file.endpoint&#125;&quot;)</span><br>    <span class="hljs-keyword">private</span> String endpoint;<br><br>    <span class="hljs-meta">@Value(&quot;$&#123;aliyun.oss.file.keyid&#125;&quot;)</span><br>    <span class="hljs-keyword">private</span> String keyId;<br><br>    <span class="hljs-meta">@Value(&quot;$&#123;aliyun.oss.file.keysecret&#125;&quot;)</span><br>    <span class="hljs-keyword">private</span> String keySecret;<br><br>    <span class="hljs-meta">@Value(&quot;$&#123;aliyun.oss.file.bucketname&#125;&quot;)</span><br>    <span class="hljs-keyword">private</span> String bucketName;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String END_POINT;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String ACCESS_KEY_ID;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String ACCESS_KEY_SECRET;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String BUCKET_NAME;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">afterPropertiesSet</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        END_POINT = endpoint;<br>        ACCESS_KEY_ID = keyId;<br>        ACCESS_KEY_SECRET = keySecret;<br>        BUCKET_NAME = bucketName;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>InitializingBean这个接口是为了让其他人可以调用里面定义的属性</p>
<h2 id="后端接口实现"><a href="#后端接口实现" class="headerlink" title="后端接口实现"></a>后端接口实现</h2><p>在com.atguigu.oss.controller创建OssController类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-meta">@RequestMapping(&quot;eduoss/fileoss&quot;)</span><br><span class="hljs-meta">@CrossOrigin</span><br><span class="hljs-meta">@Api(description = &quot;Oss文件上传&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OssController</span> </span>&#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> OssService ossService;<br><br>    <span class="hljs-comment">// 上传头像方法</span><br>    <span class="hljs-meta">@ApiOperation(&quot;头像上传&quot;)</span><br>    <span class="hljs-meta">@PostMapping</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> R <span class="hljs-title">uploadFile</span><span class="hljs-params">(<span class="hljs-meta">@ApiParam(name = &quot;file&quot;,value = &quot;上传文件&quot;,required = false)</span> MultipartFile file)</span></span>&#123;<br>        <span class="hljs-comment">// 获取上传文件，MultipartFile</span><br>        <span class="hljs-comment">// 返回上传文件的oss路径</span><br>        String url = ossService.uploadFileAvatar(file);<br>        <span class="hljs-keyword">return</span> R.ok().data(<span class="hljs-string">&quot;url&quot;</span>,url);<br>    &#125;<br><br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>在com.atguigu.oss.service创建service接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">OssService</span> </span>&#123;<br>    <span class="hljs-comment">// 上传头像方法</span><br>    <span class="hljs-function">String <span class="hljs-title">uploadFileAvatar</span><span class="hljs-params">(MultipartFile file)</span></span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>在com.atguigu.oss.service.impl实现service接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OssServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">OssService</span> </span>&#123;<br><br>    <span class="hljs-comment">// 上传头像方法</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">uploadFileAvatar</span><span class="hljs-params">(MultipartFile file)</span> </span>&#123;<br>        <span class="hljs-comment">// 工具类获取值</span><br>        String endpoint = ConstantPropertiesUtils.END_POINT;<br>        String accessKeyId = ConstantPropertiesUtils.ACCESS_KEY_ID;<br>        String accessKeySecret = ConstantPropertiesUtils.ACCESS_KEY_SECRET;<br>        String bucketName = ConstantPropertiesUtils.BUCKET_NAME;<br><br><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">// 创建ossClient实例</span><br>            OSS ossClient = <span class="hljs-keyword">new</span> OSSClientBuilder().build(endpoint, accessKeyId, accessKeySecret);<br><br>            <span class="hljs-comment">// 上传文件流</span><br>            InputStream inputStream = file.getInputStream();<br><br>            <span class="hljs-comment">// 获取文件名称</span><br>            String filename = file.getOriginalFilename();<br><br>            <span class="hljs-comment">// 第一个参数：bucket名称</span><br>            <span class="hljs-comment">// 第二个参数：上传到oss文件路径和文件名称 /aa/bb/1.jpg</span><br>            <span class="hljs-comment">// 第三个参数：上传文件流</span><br>            ossClient.putObject(bucketName, filename, inputStream);<br><br>            <span class="hljs-comment">// 关闭OSSClient。</span><br>            ossClient.shutdown();<br><br>            <span class="hljs-comment">// 返回url</span><br>            <span class="hljs-comment">// https://project-guli-oss.oss-cn-shenzhen.aliyuncs.com/1.png</span><br>            String url = <span class="hljs-string">&quot;https://&quot;</span>+bucketName+<span class="hljs-string">&quot;.&quot;</span>+endpoint+<span class="hljs-string">&quot;/&quot;</span>+filename;<br>            <span class="hljs-keyword">return</span> url;<br><br>        &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>            e.printStackTrace();<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>



<p>利用swagger-ui进行测试。</p>
<h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><ol>
<li>多次上传相同名称文件，造成最后一次上传会把之前上传的文件覆盖</li>
<li>把文件进行分类管理</li>
</ol>
<p><strong>解决方案</strong></p>
<ol>
<li>在文件名称添加随机唯一值，让每个文件名不同</li>
<li>利用DateTime进行分类</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OssServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">OssService</span> </span>&#123;<br><br>    <span class="hljs-comment">// 上传头像方法</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">uploadFileAvatar</span><span class="hljs-params">(MultipartFile file)</span> </span>&#123;<br>        <span class="hljs-comment">// 工具类获取值</span><br>        String endpoint = ConstantPropertiesUtils.END_POINT;<br>        String accessKeyId = ConstantPropertiesUtils.ACCESS_KEY_ID;<br>        String accessKeySecret = ConstantPropertiesUtils.ACCESS_KEY_SECRET;<br>        String bucketName = ConstantPropertiesUtils.BUCKET_NAME;<br><br><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">// 创建ossClient实例</span><br>            OSS ossClient = <span class="hljs-keyword">new</span> OSSClientBuilder().build(endpoint, accessKeyId, accessKeySecret);<br><br>            <span class="hljs-comment">// 上传文件流</span><br>            InputStream inputStream = file.getInputStream();<br><br>            <span class="hljs-comment">// 获取文件名称</span><br>            String fileName = file.getOriginalFilename();<br><br>            <span class="hljs-comment">// 1.在文件名里面添加随机唯一值</span><br>            String uuid = UUID.randomUUID().toString().replaceAll(<span class="hljs-string">&quot;-&quot;</span>, <span class="hljs-string">&quot;&quot;</span>);<br>            <span class="hljs-comment">// 24g501.jpg</span><br>            fileName = uuid+fileName;<br><br>            <span class="hljs-comment">// 2.将文件按照日期分类管理</span><br>            <span class="hljs-comment">// 2021/1/1</span><br>            String datePath = <span class="hljs-keyword">new</span> DateTime().toString(<span class="hljs-string">&quot;yyyy/MM/dd&quot;</span>);<br>            <span class="hljs-comment">// 拼接</span><br>            <span class="hljs-comment">// 2021/1/1/ge3201.jgp</span><br>            fileName = datePath+<span class="hljs-string">&quot;/&quot;</span>+fileName;<br><br>            <span class="hljs-comment">// 第一个参数：bucket名称</span><br>            <span class="hljs-comment">// 第二个参数：上传到oss文件路径和文件名称 /aa/bb/1.jpg</span><br>            <span class="hljs-comment">// 第三个参数：上传文件流</span><br>            ossClient.putObject(bucketName, fileName, inputStream);<br><br>            <span class="hljs-comment">// 关闭OSSClient。</span><br>            ossClient.shutdown();<br><br>            <span class="hljs-comment">// 返回url</span><br>            <span class="hljs-comment">// https://project-guli-oss.oss-cn-shenzhen.aliyuncs.com/1.png</span><br>            String url = <span class="hljs-string">&quot;https://&quot;</span>+bucketName+<span class="hljs-string">&quot;.&quot;</span>+endpoint+<span class="hljs-string">&quot;/&quot;</span>+fileName;<br>            <span class="hljs-keyword">return</span> url;<br><br>        &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>            e.printStackTrace();<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>



<h1 id="Nginx回顾"><a href="#Nginx回顾" class="headerlink" title="Nginx回顾"></a>Nginx回顾</h1><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p><img src="/myBlog/day06-%E6%95%B4%E5%90%88%E9%98%BF%E9%87%8C%E4%BA%91oss%E5%92%8CExcel%E5%AF%BC%E5%85%A5%E5%88%86%E7%B1%BB/07-nginx%E6%A6%82%E5%BF%B5%E5%9B%9E%E9%A1%BE.png" srcset="/myBlog/img/loading.gif" lazyload alt="07-nginx概念回顾"></p>
<p>下载Nginx压缩包，解压直接使用。使用方式，通过cmd启动，关闭Nginx利用命令Nginx程序名 -s stop</p>
<h2 id="Nginx配置"><a href="#Nginx配置" class="headerlink" title="Nginx配置"></a>Nginx配置</h2><p>修改Nginx端口，80改为81</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">server</span> &#123;<br>        <span class="hljs-attribute">listen</span>       <span class="hljs-number">81</span>;<br>        <span class="hljs-attribute">server_name</span>  localhost;<br></code></pre></td></tr></table></figure>



<p>在http内加入以下转发规则</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">server</span> &#123;<br>		<span class="hljs-attribute">listen</span>       <span class="hljs-number">9001</span>;<br>		<span class="hljs-attribute">server_name</span>  localhost;<br>	<br>		<span class="hljs-attribute">location</span> <span class="hljs-regexp">~ /eduservice/</span> &#123;           <br>			<span class="hljs-attribute">proxy_pass</span> http://localhost:8001;<br>		&#125;<br>	<br>		<span class="hljs-attribute">location</span> <span class="hljs-regexp">~ /eduoss/</span> &#123;           <br>			<span class="hljs-attribute">proxy_pass</span> http://localhost:8002;<br>		&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/myBlog/day06-%E6%95%B4%E5%90%88%E9%98%BF%E9%87%8C%E4%BA%91oss%E5%92%8CExcel%E5%AF%BC%E5%85%A5%E5%88%86%E7%B1%BB/image-20211224141522821.png" srcset="/myBlog/img/loading.gif" lazyload alt="image-20211224141522821"></p>
<p>最后再前端config/dev.env.js中的地址改成Nginx的地址，最后启动服务器测试，观察请求路径是否为Nginx配置的就可以。 </p>
<h1 id="讲师管理-上传讲师头像前端实现"><a href="#讲师管理-上传讲师头像前端实现" class="headerlink" title="讲师管理-上传讲师头像前端实现"></a>讲师管理-上传讲师头像前端实现</h1><h2 id="复制头像上传组件"><a href="#复制头像上传组件" class="headerlink" title="复制头像上传组件"></a>复制头像上传组件</h2><p><strong>从vue-element-admin复制组件：</strong></p>
<p>vue-element-admin/src/components/ImageCropper</p>
<p>vue-element-admin/src/components/PanThumb</p>
<h2 id="前端添加文件上传组件"><a href="#前端添加文件上传组件" class="headerlink" title="前端添加文件上传组件"></a>前端添加文件上传组件</h2><p><strong>src/views/edu/teacher/save.vue</strong></p>
<p>template：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs vue">!-- 讲师头像：TODO --&gt;<br>       &lt;!-- 讲师头像 --&gt;<br>        &lt;el-form-item label=&quot;讲师头像&quot;&gt;<br><br>            &lt;!-- 头衔缩略图 --&gt;<br>            &lt;pan-thumb :image=&quot;teacher.avatar&quot;/&gt;<br><br>            &lt;!-- 文件上传按钮 --&gt;<br>            &lt;el-button type=&quot;primary&quot; icon=&quot;el-icon-upload&quot; @click=&quot;imagecropperShow=true&quot;&gt;更换头像<br>            &lt;/el-button&gt;<br>            &lt;!--<br>            v-show：是否显示上传组件<br>            :key：类似于id，如果一个页面多个图片上传控件，可以做区分<br>            :url：后台上传的url地址<br>            @close：关闭上传组件<br>            @crop-upload-success：上传成功后的回调 --&gt;<br>            &lt;image-cropper<br>                        v-show=&quot;imagecropperShow&quot;<br>                        :width=&quot;300&quot;<br>                        :height=&quot;300&quot;<br>                        :key=&quot;imagecropperKey&quot;<br>                        :url=&quot;BASE_API+&#x27;/eduoss/fileoss&#x27;&quot;<br>                        field=&quot;file&quot;<br>                        @close=&quot;close&quot;<br>                        @crop-upload-success=&quot;cropSuccess&quot;/&gt;<br>        &lt;/el-form-item&gt;<br></code></pre></td></tr></table></figure>

<p>引入组件模块</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vue">import ImageCropper from &#x27;@/components/ImageCropper&#x27;<br>import PanThumb from &#x27;@/components/PanThumb&#x27;<br></code></pre></td></tr></table></figure>

<h2 id="设置默认头像"><a href="#设置默认头像" class="headerlink" title="设置默认头像"></a>设置默认头像</h2><p>config/dev.env.js中添加阿里云oss bucket地址</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">OSS_PATH: <span class="hljs-string">&#x27;&quot;https://guli-file.oss-cn-beijing.aliyuncs.com&quot;&#x27;</span><br></code></pre></td></tr></table></figure>

<p>组件中初始化头像默认地址</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs vue">const defaultForm = &#123;<br>  ......,<br>  avatar: process.env.OSS_PATH + &#x27;/avatar/default.jpg&#x27;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="js脚本实现上传和图片回显"><a href="#js脚本实现上传和图片回显" class="headerlink" title="js脚本实现上传和图片回显"></a>js脚本实现上传和图片回显</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs vue">export default &#123;<br>    components: &#123; ImageCropper, PanThumb &#125;,<br>    data()&#123;<br>        return&#123;<br>           ...<br>            BASE_API: process.env.BASE_API, // 接口API地址<br>            imagecropperShow: false, // 是否显示上传组件<br>            imagecropperKey: 0, // 上传组件id<br>            saveBtnDisabled:false    // 保存按钮是否禁止<br>        &#125;<br>    &#125;,<br>    ....<br>    methods:&#123;<br>        // 上传成功饭的回调函数<br>        cropSuccess(data)&#123;<br>            this.imagecropperShow = false<br>            this.teacher.avatar = data.url<br>            // 上传成功后，重新打开上传组件时初始化组件，否则显示上一次的上传结果<br>            this.imagecropperKey = this.imagecropperKey + 1<br>        &#125;,<br><br>        // 关闭上传组件<br>        close()&#123;<br>            this.imagecropperShow = false<br>			// 上传失败后，重新打开上传组件时初始化组件，否则显示上一次的上传结果<br>     		 this.imagecropperKey = this.imagecropperKey + 1<br>        &#125;,<br><br>      ....<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>



<p>测试</p>
<h1 id="课程分类管理-添加课程分类后端"><a href="#课程分类管理-添加课程分类后端" class="headerlink" title="课程分类管理-添加课程分类后端"></a>课程分类管理-添加课程分类后端</h1><h2 id="EasyExcel写操作"><a href="#EasyExcel写操作" class="headerlink" title="EasyExcel写操作"></a>EasyExcel写操作</h2><p>出了下面这个，还需要poi依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- https://mvnrepository.com/artifact/com.alibaba/easyexcel --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>easyexcel<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.1.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.poi<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>poi<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.17<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>编写实体类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DemoData</span> </span>&#123;<br>	<span class="hljs-comment">// 设置Excel表头名称</span><br>    <span class="hljs-meta">@ExcelProperty(&quot;学生编号&quot;)</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> sno;<br><br>    <span class="hljs-meta">@ExcelProperty(&quot;学生姓名&quot;)</span><br>    <span class="hljs-keyword">private</span> String sname;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestExcel</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        String fileName = <span class="hljs-string">&quot;E:\\1\\write.xlsx&quot;</span>;<br>        <span class="hljs-comment">// 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span><br>        <span class="hljs-comment">// 如果这里想使用03 则 传入excelType参数即可</span><br>        EasyExcel.write(fileName,DemoData.class).sheet(<span class="hljs-string">&quot;学生信息&quot;</span>).doWrite(getData());<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> List&lt;DemoData&gt; <span class="hljs-title">getData</span><span class="hljs-params">()</span></span>&#123;<br>        List&lt;DemoData&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;<br>            DemoData demoData = <span class="hljs-keyword">new</span> DemoData();<br>            demoData.setSno(i);<br>            demoData.setSname(<span class="hljs-string">&quot;lucy&quot;</span> + i);<br>            list.add(demoData);<br>        &#125;<br>        <span class="hljs-keyword">return</span> list;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>



<h2 id="EasyExcel读操作"><a href="#EasyExcel读操作" class="headerlink" title="EasyExcel读操作"></a>EasyExcel读操作</h2><p>编写实体类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DemoData</span> </span>&#123;<br>    <span class="hljs-comment">// 设置Excel表头名称</span><br>    <span class="hljs-meta">@ExcelProperty(value = &quot;学生编号&quot;,index = 0)</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> sno;<br><br>    <span class="hljs-meta">@ExcelProperty(value = &quot;学生姓名&quot;,index = 1)</span><br>    <span class="hljs-keyword">private</span> String sname;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>创建监听器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 创建监听器</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ExcelListener</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AnalysisEventListener</span>&lt;<span class="hljs-title">DemoData</span>&gt; </span>&#123;<br><br>    <span class="hljs-comment">// 一行一行的读，不读表头</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">invoke</span><span class="hljs-params">(DemoData data, AnalysisContext analysisContext)</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;****&quot;</span> + data);<br>    &#125;<br><br>    <span class="hljs-comment">// 读表头</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">invokeHeadMap</span><span class="hljs-params">(Map&lt;Integer, String&gt; headMap, AnalysisContext context)</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;表头&quot;</span> + headMap);<br>    &#125;<br><br>    <span class="hljs-comment">// 完成读后的操作</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doAfterAllAnalysed</span><span class="hljs-params">(AnalysisContext analysisContext)</span> </span>&#123;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>    <span class="hljs-comment">// 写</span><br>    <span class="hljs-comment">/*String fileName = &quot;E:\\1\\write.xlsx&quot;;</span><br><span class="hljs-comment">    // 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span><br><span class="hljs-comment">    // 如果这里想使用03 则 传入excelType参数即可</span><br><span class="hljs-comment">    EasyExcel.write(fileName,DemoData.class).sheet(&quot;学生信息&quot;).doWrite(getData());*/</span><br><br>    <span class="hljs-comment">// 读Excel操作</span><br>    String fileName = <span class="hljs-string">&quot;E:\\1\\write.xlsx&quot;</span>;<br>    EasyExcel.read(fileName,DemoData.class,<span class="hljs-keyword">new</span> ExcelListener()).sheet().doRead();<br>&#125;<br></code></pre></td></tr></table></figure>

<p>结果</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">表头&#123;0=学生编号, 1=学生姓名&#125;<br>****DemoData(sno=0, sname=lucy0)<br>****DemoData(sno=1, sname=lucy1)<br>****DemoData(sno=2, sname=lucy2)<br>****DemoData(sno=3, sname=lucy3)<br>****DemoData(sno=4, sname=lucy4)<br>****DemoData(sno=5, sname=lucy5)<br>****DemoData(sno=6, sname=lucy6)<br>****DemoData(sno=7, sname=lucy7)<br>****DemoData(sno=8, sname=lucy8)<br>****DemoData(sno=9, sname=lucy9)<br></code></pre></td></tr></table></figure>



<h2 id="添加课程分类"><a href="#添加课程分类" class="headerlink" title="添加课程分类"></a>添加课程分类</h2><p>导入依赖，上面已经导入了，不需要再次导入</p>
<p>利用代码生成器生成代码</p>
<p>编写controller</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-meta">@RequestMapping(&quot;/eduservice/subject&quot;)</span><br><span class="hljs-meta">@CrossOrigin</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EduSubjectController</span> </span>&#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> EduSubjectService subjectService;<br><br>    <span class="hljs-comment">// 添加课程分类</span><br>    <span class="hljs-comment">// 获取上传的文件，把文件内容读取出来</span><br>    <span class="hljs-meta">@PostMapping(&quot;addSubject&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> R <span class="hljs-title">addSubject</span><span class="hljs-params">(MultipartFile file)</span></span>&#123;<br>        <span class="hljs-comment">// 上传过来的Excel文件</span><br>        subjectService.saveSubject(file, subjectService);<br>        <span class="hljs-keyword">return</span> R.ok();<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>编写service接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">EduSubjectService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">IService</span>&lt;<span class="hljs-title">EduSubject</span>&gt; </span>&#123;<br><br>    <span class="hljs-comment">// 添加课程分类</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">saveSubject</span><span class="hljs-params">(MultipartFile file,EduSubjectService subjectService)</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>编写service实现类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EduSubjectServiceImpl</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ServiceImpl</span>&lt;<span class="hljs-title">EduSubjectMapper</span>, <span class="hljs-title">EduSubject</span>&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title">EduSubjectService</span> </span>&#123;<br><br>    <span class="hljs-comment">// 添加课程分类</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">saveSubject</span><span class="hljs-params">(MultipartFile file,EduSubjectService subjectService)</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">// 文件输入流</span><br>            InputStream in = file.getInputStream();<br>            <span class="hljs-comment">// 调用方法进行读取</span><br>            EasyExcel.read(in, SubjectData.class,<span class="hljs-keyword">new</span> SubjectExcelListener(subjectService)).sheet().doRead();<br>        &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>在com.atguigu.eduservice.entity.excel中编写表格的属性实体类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SubjectData</span> </span>&#123;<br><br>    <span class="hljs-meta">@ExcelProperty(index = 0)</span><br>    <span class="hljs-keyword">private</span> String oneSubjectName;<br>    <span class="hljs-meta">@ExcelProperty(index = 1)</span><br>    <span class="hljs-keyword">private</span> String twoSubjectName;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>在com.atguigu.eduservice.listener编写监听类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SubjectExcelListener</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AnalysisEventListener</span>&lt;<span class="hljs-title">SubjectData</span>&gt; </span>&#123;<br><br>    <span class="hljs-comment">// 因为SubjectExcelListener不能交给spring管理，需要自己new，不能注入其他对象</span><br>    <span class="hljs-comment">// 不能实现数据的操作</span><br>    <span class="hljs-keyword">public</span> EduSubjectService subjectService;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">SubjectExcelListener</span><span class="hljs-params">()</span> </span>&#123;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">SubjectExcelListener</span><span class="hljs-params">(EduSubjectService subjectService)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.subjectService = subjectService;<br>    &#125;<br><br>    <span class="hljs-comment">// 一行一行读取</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">invoke</span><span class="hljs-params">(SubjectData subjectData, AnalysisContext analysisContext)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (subjectData == <span class="hljs-keyword">null</span>)&#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> GuliException(<span class="hljs-number">20001</span>,<span class="hljs-string">&quot;文件数据为空&quot;</span>);<br>        &#125;<br><br>        <span class="hljs-comment">// 一行一行读取，每次读取有两个值，第一个值一级分类，第二值二级分类</span><br>        <span class="hljs-comment">// 判断一级分类是否重复</span><br>        EduSubject exitOneSubject = <span class="hljs-keyword">this</span>.exitOneSubject(subjectService, subjectData.getOneSubjectName());<br>        <span class="hljs-keyword">if</span> (exitOneSubject == <span class="hljs-keyword">null</span>)&#123;    <span class="hljs-comment">// 说明不存在相同的一级分类，可以添加</span><br>            exitOneSubject = <span class="hljs-keyword">new</span> EduSubject();<br>            exitOneSubject.setParentId(<span class="hljs-string">&quot;0&quot;</span>);<br>            exitOneSubject.setTitle(subjectData.getOneSubjectName());<br>            subjectService.save(exitOneSubject);<br>        &#125;<br><br>        <span class="hljs-comment">// 获取一级分类id</span><br>        String pid = exitOneSubject.getId();<br><br>        <span class="hljs-comment">// 判断二级分类是否重复</span><br>        EduSubject exitTwoSubject = <span class="hljs-keyword">this</span>.exitTwoSubject(subjectService, subjectData.getOneSubjectName(),pid);<br>        <span class="hljs-keyword">if</span> (exitTwoSubject == <span class="hljs-keyword">null</span>)&#123;    <span class="hljs-comment">// 说明不存在相同的一级分类，可以添加</span><br>            exitTwoSubject = <span class="hljs-keyword">new</span> EduSubject();<br>            exitTwoSubject.setParentId(pid);<br>            exitTwoSubject.setTitle(subjectData.getTwoSubjectName());<br>            subjectService.save(exitTwoSubject);<br>        &#125;<br><br>    &#125;<br><br>    <span class="hljs-comment">// 判断一级分类不能重复添加</span><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> EduSubject <span class="hljs-title">exitOneSubject</span><span class="hljs-params">(EduSubjectService subjectService,String name)</span></span>&#123;<br>        QueryWrapper&lt;EduSubject&gt; wrapper = <span class="hljs-keyword">new</span> QueryWrapper&lt;&gt;();<br>        wrapper.eq(<span class="hljs-string">&quot;title&quot;</span>,name);<br>        wrapper.eq(<span class="hljs-string">&quot;parent_id&quot;</span>,<span class="hljs-string">&quot;0&quot;</span>);<br>        EduSubject oneSubject = subjectService.getOne(wrapper);<br>        <span class="hljs-keyword">return</span> oneSubject;<br>    &#125;<br><br>    <span class="hljs-comment">// 判断二级分类不能重复添加</span><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> EduSubject <span class="hljs-title">exitTwoSubject</span><span class="hljs-params">(EduSubjectService subjectService,String name,String pid)</span></span>&#123;<br>        QueryWrapper&lt;EduSubject&gt; wrapper = <span class="hljs-keyword">new</span> QueryWrapper&lt;&gt;();<br>        wrapper.eq(<span class="hljs-string">&quot;title&quot;</span>,name);<br>        wrapper.eq(<span class="hljs-string">&quot;parent_id&quot;</span>,pid);<br>        EduSubject twoSubject = subjectService.getOne(wrapper);<br>        <span class="hljs-keyword">return</span> twoSubject;<br>    &#125;<br><br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doAfterAllAnalysed</span><span class="hljs-params">(AnalysisContext analysisContext)</span> </span>&#123;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>利用swagger测试。</p>
<h1 id="课程分类管理-添加课程分类前端"><a href="#课程分类管理-添加课程分类前端" class="headerlink" title="课程分类管理-添加课程分类前端"></a>课程分类管理-添加课程分类前端</h1><h2 id="添加路由"><a href="#添加路由" class="headerlink" title="添加路由"></a>添加路由</h2><p>vue-admin-template-master\src\router\index.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs js">&#123;<br>    <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/subject&#x27;</span>,<br>    <span class="hljs-attr">component</span>: Layout,<br>    <span class="hljs-attr">redirect</span>: <span class="hljs-string">&#x27;/subject/list&#x27;</span>,<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;课程分类管理&#x27;</span>,<br>    <span class="hljs-attr">meta</span>: &#123; <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;课程分类管理&#x27;</span>, <span class="hljs-attr">icon</span>: <span class="hljs-string">&#x27;example&#x27;</span> &#125;,<br>    <span class="hljs-attr">children</span>: [<br>      &#123;<br>        <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;list&#x27;</span>,<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;课程列表&#x27;</span>,<br>        <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;@/views/edu/subject/list&#x27;</span>),<br>        <span class="hljs-attr">meta</span>: &#123; <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;课程列表&#x27;</span>, <span class="hljs-attr">icon</span>: <span class="hljs-string">&#x27;table&#x27;</span> &#125;<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;save&#x27;</span>,<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;添加课程分类&#x27;</span>,<br>        <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;@/views/edu/subject/save&#x27;</span>),<br>        <span class="hljs-attr">meta</span>: &#123; <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;添加课程分类&#x27;</span>, <span class="hljs-attr">icon</span>: <span class="hljs-string">&#x27;tree&#x27;</span> &#125;<br>      &#125;<br>    ]<br>  &#125;,<br></code></pre></td></tr></table></figure>

<h2 id="添加vue组件"><a href="#添加vue组件" class="headerlink" title="添加vue组件"></a>添加vue组件</h2><p>list.vue和save.vue</p>
<h2 id="template"><a href="#template" class="headerlink" title="template"></a>template</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>   &lt;div class=&quot;app-container&quot;&gt;<br>     &lt;el-form label-width=&quot;120px&quot;&gt;<br>       &lt;el-form-item label=&quot;信息描述&quot;&gt;<br>         &lt;el-tag type=&quot;info&quot;&gt;excel模版说明&lt;/el-tag&gt;<br>         &lt;el-tag&gt;<br>           &lt;i class=&quot;el-icon- &quot;/&gt;<br>           &lt;a :href=&quot;&#x27;/static/01.xlsx&#x27;&quot;&gt;点击下载模版&lt;/a&gt;<br>         &lt;/el-tag&gt;<br>       &lt;/el-form-item&gt;<br>       &lt;el-form-item label=&quot;选择Excel&quot;&gt;<br>         &lt;el-upload<br>           ref=&quot;upload&quot;<br>           :auto-upload=&quot;false&quot;<br>           :on-success=&quot;fileUploadSuccess&quot;<br>           :on-error=&quot;fileUploadError&quot;<br>           :disabled=&quot;importBtnDisabled&quot;<br>           :limit=&quot;1&quot;<br>           :action=&quot;BASE_API+&#x27;/eduservice/subject/addSubject&#x27;&quot;<br>           name=&quot;file&quot;<br>           accept=&quot;application/vnd.ms-excel&quot;&gt;<br>           &lt;el-button slot=&quot;trigger&quot; size=&quot;small&quot; type=&quot;primary&quot;&gt;选取文件&lt;/el-button&gt;<br>           &lt;el-button<br>             :loading=&quot;loading&quot;<br>             style=&quot;margin-left: 10px;&quot;<br>             size=&quot;small&quot;<br>             type=&quot;success&quot;<br>             @click=&quot;submitUpload&quot;&gt;上传到服务器&lt;/el-button&gt;<br>         &lt;/el-upload&gt;<br>       &lt;/el-form-item&gt;<br>     &lt;/el-form&gt;<br>   &lt;/div&gt;<br> &lt;/template&gt;<br></code></pre></td></tr></table></figure>

<h2 id="js定义数据"><a href="#js定义数据" class="headerlink" title="js定义数据"></a>js定义数据</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;script&gt;<br> export default &#123;<br>     data()&#123;<br><br>         return&#123;<br>            BASE_API: process.env.BASE_API,     // 接口API地址<br>            importBtnDisabled: false,           // 按钮是否禁用,<br>            loading: false<br>         &#125;<br><br>     &#125;,<br>     created()&#123;<br><br>     &#125;,<br>     methods:&#123;<br>         // 上传到服务器<br>         submitUpload()&#123;<br>           <br>         &#125;,<br>         // 上传成功<br>         fileUploadSuccess()&#123;<br>           <br>         &#125;,<br><br>         // 上传失败<br>         fileUploadError()&#123;<br>         <br>         &#125;<br>     &#125;<br> &#125;<br> &lt;/script&gt;<br></code></pre></td></tr></table></figure>

<h2 id="js上传方法"><a href="#js上传方法" class="headerlink" title="js上传方法"></a>js上传方法</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs vue">// 上传到服务器<br>submitUpload()&#123;<br>    this.fileUploadBtnText = &#x27;正在上传&#x27;<br>    this.importBtnDisabled = true<br>    this.loading = true<br>    this.$refs.upload.submit()<br>&#125;,<br></code></pre></td></tr></table></figure>

<h2 id="回调函数"><a href="#回调函数" class="headerlink" title="回调函数"></a>回调函数</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs vue">// 上传成功<br>fileUploadSuccess()&#123;<br>    this.loading = false<br>    this.$message(&#123;<br>        type: &#x27;success&#x27;,<br>        message: &#x27;添加课程分类成功&#x27;<br>	&#125;)<br>// 跳转到课程分类列表<br>&#125;,<br><br>// 上传失败<br>fileUploadError()&#123;<br>    this.loading = false<br>    this.$message(&#123;<br>        type: &#x27;error&#x27;,<br>        message: &#x27;添加课程分类失败&#x27;<br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure>

<p>save.vue完整代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>   &lt;div class=&quot;app-container&quot;&gt;<br>     &lt;el-form label-width=&quot;120px&quot;&gt;<br>       &lt;el-form-item label=&quot;信息描述&quot;&gt;<br>         &lt;el-tag type=&quot;info&quot;&gt;excel模版说明&lt;/el-tag&gt;<br>         &lt;el-tag&gt;<br>           &lt;i class=&quot;el-icon- &quot;/&gt;<br>           &lt;a :href=&quot;&#x27;/static/01.xlsx&#x27;&quot;&gt;点击下载模版&lt;/a&gt;<br>         &lt;/el-tag&gt;<br>       &lt;/el-form-item&gt;<br>       &lt;el-form-item label=&quot;选择Excel&quot;&gt;<br>         &lt;el-upload<br>           ref=&quot;upload&quot;<br>           :auto-upload=&quot;false&quot;<br>           :on-success=&quot;fileUploadSuccess&quot;<br>           :on-error=&quot;fileUploadError&quot;<br>           :disabled=&quot;importBtnDisabled&quot;<br>           :limit=&quot;1&quot;<br>           :action=&quot;BASE_API+&#x27;/eduservice/subject/addSubject&#x27;&quot;<br>           name=&quot;file&quot;<br>           accept=&quot;application/vnd.ms-excel&quot;&gt;<br>           &lt;el-button slot=&quot;trigger&quot; size=&quot;small&quot; type=&quot;primary&quot;&gt;选取文件&lt;/el-button&gt;<br>           &lt;el-button<br>             :loading=&quot;loading&quot;<br>             style=&quot;margin-left: 10px;&quot;<br>             size=&quot;small&quot;<br>             type=&quot;success&quot;<br>             @click=&quot;submitUpload&quot;&gt;上传到服务器&lt;/el-button&gt;<br>         &lt;/el-upload&gt;<br>       &lt;/el-form-item&gt;<br>     &lt;/el-form&gt;<br>   &lt;/div&gt;<br> &lt;/template&gt;<br><br> &lt;script&gt;<br> export default &#123;<br>     data()&#123;<br><br>         return&#123;<br>            BASE_API: process.env.BASE_API,     // 接口API地址<br>            importBtnDisabled: false,           // 按钮是否禁用,<br>            loading: false<br>         &#125;<br><br>     &#125;,<br>     created()&#123;<br><br>     &#125;,<br>     methods:&#123;<br>         // 上传到服务器<br>         submitUpload()&#123;<br>            this.fileUploadBtnText = &#x27;正在上传&#x27;<br>            this.importBtnDisabled = true<br>            this.loading = true<br>            this.$refs.upload.submit()<br>         &#125;,<br>         // 上传成功<br>         fileUploadSuccess()&#123;<br>            this.loading = false<br>            this.$message(&#123;<br>            type: &#x27;success&#x27;,<br>                message: &#x27;添加课程分类成功&#x27;<br>            &#125;)<br>            // 跳转到课程分类列表，路由转发<br>            this.$router.push(&#123;path:&#x27;/subject/list&#x27;&#125;)<br>         &#125;,<br><br>         // 上传失败<br>         fileUploadError()&#123;<br>            this.loading = false<br>            this.$message(&#123;<br>                type: &#x27;error&#x27;,<br>                message: &#x27;添加课程分类失败&#x27;<br>            &#125;)<br>         &#125;<br><br>     &#125;<br> &#125;<br> &lt;/script&gt;<br></code></pre></td></tr></table></figure>





<h1 id="课程分类管理-课程分类显示接口"><a href="#课程分类管理-课程分类显示接口" class="headerlink" title="课程分类管理-课程分类显示接口"></a>课程分类管理-课程分类显示接口</h1><p>树形结构，框架需要的返回数据，进行接口的编写</p>
<h2 id="实体类"><a href="#实体类" class="headerlink" title="实体类"></a>实体类</h2><p>在com.atguigu.eduservice.entity.subject下创建对应的实体类</p>
<p>一级分类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 一级分类</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OneSubject</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String id;<br>    <span class="hljs-keyword">private</span> String title;<br>    <span class="hljs-comment">// 存放二级分类</span><br>    List&lt;TwoSubject&gt; children = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>二级分类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 二级分类</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TwoSubject</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String id;<br>    <span class="hljs-keyword">private</span> String title;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="controller"><a href="#controller" class="headerlink" title="controller"></a>controller</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-meta">@RequestMapping(&quot;/eduservice/subject&quot;)</span><br><span class="hljs-meta">@CrossOrigin</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EduSubjectController</span> </span>&#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> EduSubjectService subjectService;<br><br>	....<br><br>    <span class="hljs-comment">// 查看所有课程分类（树形结构）</span><br>    <span class="hljs-meta">@GetMapping(&quot;findAllSubject&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> R <span class="hljs-title">findAllSubject</span><span class="hljs-params">()</span></span>&#123;<br>        List&lt;OneSubject&gt; allSubjectList = subjectService.findOneTwoSubject();<br>        <span class="hljs-keyword">return</span> R.ok().data(<span class="hljs-string">&quot;allSubjectList&quot;</span>,allSubjectList);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="service接口"><a href="#service接口" class="headerlink" title="service接口"></a>service接口</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">EduSubjectService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">IService</span>&lt;<span class="hljs-title">EduSubject</span>&gt; </span>&#123;<br><br>    ....<br>        <br>    <span class="hljs-comment">// 查看所有课程分类（树形结构）</span><br>    <span class="hljs-function">List&lt;OneSubject&gt; <span class="hljs-title">findOneTwoSubject</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="serviceImpl实现类"><a href="#serviceImpl实现类" class="headerlink" title="serviceImpl实现类"></a>serviceImpl实现类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EduSubjectServiceImpl</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ServiceImpl</span>&lt;<span class="hljs-title">EduSubjectMapper</span>, <span class="hljs-title">EduSubject</span>&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title">EduSubjectService</span> </span>&#123;<br><br>		....<br>            <br>    <span class="hljs-comment">// 查看所有课程分类（树形结构）</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;OneSubject&gt; <span class="hljs-title">findOneTwoSubject</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-comment">// 一级分类的parent_id为0，二级的不为0</span><br>        <span class="hljs-comment">// 1.查询所有一级分类</span><br>        QueryWrapper&lt;EduSubject&gt; oneSubjectWrapper = <span class="hljs-keyword">new</span> QueryWrapper&lt;&gt;();<br>        oneSubjectWrapper.eq(<span class="hljs-string">&quot;parent_id&quot;</span>,<span class="hljs-string">&quot;0&quot;</span>);<br><br>        <span class="hljs-comment">// 调用BaseMapper查询数据库</span><br>        List&lt;EduSubject&gt; oneSubjectsList = baseMapper.selectList(oneSubjectWrapper);<br><br>        <span class="hljs-comment">// 2.查询所有二级分类</span><br>        QueryWrapper&lt;EduSubject&gt; twoSubjectWrapper = <span class="hljs-keyword">new</span> QueryWrapper&lt;&gt;();<br>        twoSubjectWrapper.ne(<span class="hljs-string">&quot;parent_id&quot;</span>,<span class="hljs-string">&quot;0&quot;</span>);<br>        List&lt;EduSubject&gt; twoSubjectsList = baseMapper.selectList(twoSubjectWrapper);<br><br>        <span class="hljs-comment">// 创建一个最终返回的list集合</span><br>        List&lt;OneSubject&gt; finalSubjectList = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br><br>        <span class="hljs-comment">// 3.封装一级分类</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; oneSubjectsList.size(); i++)&#123;<br>            <span class="hljs-comment">// 先从集合中得到一个EduSubject对象</span><br>            EduSubject eduSubject = oneSubjectsList.get(i);<br><br>            <span class="hljs-comment">// 创建一个OneSubject对象，将从集合中取出的值加入进去oneSubject</span><br>            OneSubject oneSubject = <span class="hljs-keyword">new</span> OneSubject();<br><br>            <span class="hljs-comment">// 第一种写法</span><br>            <span class="hljs-comment">//oneSubject.setId(eduSubject.getId());</span><br>            <span class="hljs-comment">//oneSubject.setTitle(eduSubject.getTitle());</span><br><br>            <span class="hljs-comment">// 第二种写法，利用工具类，将eduSubject的值赋给oneSubject，效果和上面的一样</span><br>            BeanUtils.copyProperties(eduSubject,oneSubject);<br><br>            <span class="hljs-comment">// 将oneSubject加入到最终的集合finalSubjectList</span><br>            finalSubjectList.add(oneSubject);<br><br>            <span class="hljs-comment">// 4.封装二级分类</span><br>            <span class="hljs-comment">// 先创建一个集合保存二级分类</span><br>            List&lt;TwoSubject&gt; finalTwoSubjectList = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br><br>            <span class="hljs-comment">// 遍历twoSubjectsList，拿到数据</span><br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> m = <span class="hljs-number">0</span>; m &lt; twoSubjectsList.size(); m++) &#123;<br>                <span class="hljs-comment">// 从遍历twoSubjectsList中取一个EduSubject对象</span><br>                EduSubject tSubject = twoSubjectsList.get(m);<br><br>                <span class="hljs-comment">// 创建一个twoSubject，方便从twoSubjectsList取出来的tSubject加入</span><br>                TwoSubject twoSubject = <span class="hljs-keyword">new</span> TwoSubject();<br><br>                <span class="hljs-comment">// 判断是否需要该一级分类的</span><br>                <span class="hljs-keyword">if</span> (tSubject.getParentId().equals(eduSubject.getId()))&#123;<br>                    <span class="hljs-comment">// 如果二级分类的ParentId等于一级分类的id就说明是同一分类的，则将tSubject赋值给twoSubject</span><br>                    BeanUtils.copyProperties(tSubject,twoSubject);<br><br>                    <span class="hljs-comment">// 将赋值后的twoSubject加入到finalTwoSubjectList中</span><br>                    finalTwoSubjectList.add(twoSubject);<br>                &#125;<br>            &#125;<br>            <span class="hljs-comment">// 当这个for循环结束后，将二级分类集合加入到当前一级分类</span><br>            oneSubject.setChildren(finalTwoSubjectList);<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> finalSubjectList;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>测试</p>
<h1 id="课程分类管理-课程分类显示前端"><a href="#课程分类管理-课程分类显示前端" class="headerlink" title="课程分类管理-课程分类显示前端"></a>课程分类管理-课程分类显示前端</h1><p>在vue-admin-template-master\src\api\edu\subject.js，添加方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span>&#123;<br>    <span class="hljs-comment">// 查询课程分类列表</span><br>    <span class="hljs-function"><span class="hljs-title">getSubjectList</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> request(&#123;<br>            <span class="hljs-attr">url</span>: <span class="hljs-string">`/eduservice/subject/findAllSubject`</span>,<br>            <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;get&#x27;</span><br>          &#125;)<br>    &#125;<br>   <br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>在vue-admin-template-master\src\views\edu\subject\list.vue将data2的值置空</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs vue">data() &#123;<br>  return &#123;<br>    filterText: &#x27;&#x27;,<br>    data2: [],<br>    defaultProps: &#123;<br>      children: &#x27;children&#x27;,<br>      label: &#x27;title&#x27;<br>    &#125;<br>  &#125;<br>&#125;s<br></code></pre></td></tr></table></figure>

<p>导入方法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vue">import subject from &#x27;@/api/edu/subject&#x27;<br></code></pre></td></tr></table></figure>

<p>调用方法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs vue"> created()&#123;<br>    // 调用查询课程分类的方法<br>    this.getAllSubject()<br>  &#125;,<br>...<br><br>  methods: &#123;<br>    // 查询课程分类列表<br>    getAllSubject()&#123;<br>        subject.getSubjectList()<br>        .then(response =&gt;&#123;<br>            this.data2 = response.data.list<br>        &#125;)<br>    &#125;,<br></code></pre></td></tr></table></figure>

<p>检索功能优化，优化区分大小写，优化后不区分大小写</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs vue">filterNode(value, data) &#123;<br>      if (!value) return true<br>      return data.title.toLowerCase().indexOf(value.toLowerCase()) !== -1<br>    &#125;<br></code></pre></td></tr></table></figure>



<p>list.vue完整代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;div class=&quot;app-container&quot;&gt;<br>    &lt;el-input v-model=&quot;filterText&quot; placeholder=&quot;Filter keyword&quot; style=&quot;margin-bottom:30px;&quot; /&gt;<br><br>    &lt;el-tree<br>      ref=&quot;tree2&quot;<br>      :data=&quot;data2&quot;<br>      :props=&quot;defaultProps&quot;<br>      :filter-node-method=&quot;filterNode&quot;<br>      class=&quot;filter-tree&quot;<br>      default-expand-all<br>    /&gt;<br><br>  &lt;/div&gt;<br>&lt;/template&gt;<br><br>&lt;script&gt;<br><br>import subject from &#x27;@/api/edu/subject&#x27;<br><br>export default &#123;<br><br>  data() &#123;<br>    return &#123;<br>      filterText: &#x27;&#x27;,<br>      data2: [],<br>      defaultProps: &#123;<br>        children: &#x27;children&#x27;,<br>        label: &#x27;title&#x27;<br>      &#125;<br>    &#125;<br>  &#125;,<br>  created()&#123;<br>    // 调用查询课程分类的方法<br>    this.getAllSubject()<br>  &#125;,<br>  watch: &#123;<br>    filterText(val) &#123;<br>      this.$refs.tree2.filter(val)<br>    &#125;<br>  &#125;,<br><br>  methods: &#123;<br>    // 查询课程分类列表<br>    getAllSubject()&#123;<br>        subject.getSubjectList()<br>        .then(response =&gt;&#123;<br>            this.data2 = response.data.list<br>        &#125;)<br>    &#125;,<br><br>    filterNode(value, data) &#123;<br>      if (!value) return true<br>      return data.title.toLowerCase().indexOf(value.toLowerCase()) !== -1<br>    &#125;<br>  &#125;<br>&#125;<br>&lt;/script&gt;<br><br><br></code></pre></td></tr></table></figure>


              
            </div>
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/myBlog/categories/%E9%A1%B9%E7%9B%AE-%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2-%E7%AC%94%E8%AE%B0/" class="category-chain-item">项目|谷粒学院|笔记</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/myBlog/tags/project/">#project</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>day06-整合阿里云oss和Excel导入分类</div>
      <div>https://no-ten.github.io/day06-整合阿里云oss和Excel导入分类/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Ten</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2021年12月24日</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>许可协议</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - 署名">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/myBlog/day07-%E8%AF%BE%E7%A8%8B%E5%8F%91%E5%B8%83-%E6%B7%BB%E5%8A%A0%E8%AF%BE%E7%A8%8B%E4%BF%A1%E6%81%AF/" title="day07-课程发布-添加课程信息">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">day07-课程发布-添加课程信息</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/myBlog/day05-%E8%AE%B2%E5%B8%88%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" title="day05-讲师管理模块前端开发">
                        <span class="hidden-mobile">day05-讲师管理模块前端开发</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  






    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    
  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/myBlog/js/events.js" ></script>
<script  src="/myBlog/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>






  
    <script  src="/myBlog/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.0/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script>
  (function() {
    var enableLang = CONFIG.code_language.enable && CONFIG.code_language.default;
    var enableCopy = CONFIG.copy_btn;
    if (!enableLang && !enableCopy) {
      return;
    }

    function getBgClass(ele) {
      return Fluid.utils.getBackgroundLightness(ele) >= 0 ? 'code-widget-light' : 'code-widget-dark';
    }

    var copyTmpl = '';
    copyTmpl += '<div class="code-widget">';
    copyTmpl += 'LANG';
    copyTmpl += '</div>';
    jQuery('.markdown-body pre').each(function() {
      var $pre = jQuery(this);
      if ($pre.find('code.mermaid').length > 0) {
        return;
      }
      if ($pre.find('span.line').length > 0) {
        return;
      }

      var lang = '';

      if (enableLang) {
        lang = CONFIG.code_language.default;
        if ($pre[0].children.length > 0 && $pre[0].children[0].classList.length >= 2 && $pre.children().hasClass('hljs')) {
          lang = $pre[0].children[0].classList[1];
        } else if ($pre[0].getAttribute('data-language')) {
          lang = $pre[0].getAttribute('data-language');
        } else if ($pre.parent().hasClass('sourceCode') && $pre[0].children.length > 0 && $pre[0].children[0].classList.length >= 2) {
          lang = $pre[0].children[0].classList[1];
          $pre.parent().addClass('code-wrapper');
        } else if ($pre.parent().hasClass('markdown-body') && $pre[0].classList.length === 0) {
          $pre.wrap('<div class="code-wrapper"></div>');
        }
        lang = lang.toUpperCase().replace('NONE', CONFIG.code_language.default);
      }
      $pre.append(copyTmpl.replace('LANG', lang).replace('code-widget">',
        getBgClass($pre[0]) + (enableCopy ? ' code-widget copy-btn" data-clipboard-snippet><i class="iconfont icon-copy"></i>' : ' code-widget">')));

      if (enableCopy) {
        Fluid.utils.createScript('https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js', function() {
          var clipboard = new window.ClipboardJS('.copy-btn', {
            target: function(trigger) {
              var nodes = trigger.parentNode.childNodes;
              for (var i = 0; i < nodes.length; i++) {
                if (nodes[i].tagName === 'CODE') {
                  return nodes[i];
                }
              }
            }
          });
          clipboard.on('success', function(e) {
            e.clearSelection();
            e.trigger.innerHTML = e.trigger.innerHTML.replace('icon-copy', 'icon-success');
            setTimeout(function() {
              e.trigger.innerHTML = e.trigger.innerHTML.replace('icon-success', 'icon-copy');
            }, 2000);
          });
        });
      }
    });
  })();
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/myBlog/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/myBlog/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
