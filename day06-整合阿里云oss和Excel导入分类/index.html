

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/myBlog/img/fluid.png">
  <link rel="icon" href="/myBlog/img/browserTitle.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Ten">
  <meta name="keywords" content="">
  
    <meta name="description" content="day06-整合阿里云oss和Excel导入分类讲师管理-上传讲师头像后端接口后端环境搭建搭建阿里云OSS项目环境在service模块下创建子模块service_oss 配置pom.xml &lt;dependencies&gt;          &lt;!-- 阿里云oss依赖 --&gt;         &lt;dependency&gt;             &lt;groupId&amp;">
<meta property="og:type" content="article">
<meta property="og:title" content="day06-整合阿里云oss和Excel导入分类">
<meta property="og:url" content="https://no-ten.github.io/day06-%E6%95%B4%E5%90%88%E9%98%BF%E9%87%8C%E4%BA%91oss%E5%92%8CExcel%E5%AF%BC%E5%85%A5%E5%88%86%E7%B1%BB/index.html">
<meta property="og:site_name" content="TBlog">
<meta property="og:description" content="day06-整合阿里云oss和Excel导入分类讲师管理-上传讲师头像后端接口后端环境搭建搭建阿里云OSS项目环境在service模块下创建子模块service_oss 配置pom.xml &lt;dependencies&gt;          &lt;!-- 阿里云oss依赖 --&gt;         &lt;dependency&gt;             &lt;groupId&amp;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://no-ten.github.io/myBlog/day06-%E6%95%B4%E5%90%88%E9%98%BF%E9%87%8C%E4%BA%91oss%E5%92%8CExcel%E5%AF%BC%E5%85%A5%E5%88%86%E7%B1%BB/07-nginx%E6%A6%82%E5%BF%B5%E5%9B%9E%E9%A1%BE.png">
<meta property="og:image" content="https://no-ten.github.io/myBlog/day06-%E6%95%B4%E5%90%88%E9%98%BF%E9%87%8C%E4%BA%91oss%E5%92%8CExcel%E5%AF%BC%E5%85%A5%E5%88%86%E7%B1%BB/image-20211224141522821.png">
<meta property="article:published_time" content="2021-12-24T03:00:24.335Z">
<meta property="article:modified_time" content="2022-01-06T16:40:56.867Z">
<meta property="article:author" content="Ten">
<meta property="article:tag" content="project">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://no-ten.github.io/myBlog/day06-%E6%95%B4%E5%90%88%E9%98%BF%E9%87%8C%E4%BA%91oss%E5%92%8CExcel%E5%AF%BC%E5%85%A5%E5%88%86%E7%B1%BB/07-nginx%E6%A6%82%E5%BF%B5%E5%9B%9E%E9%A1%BE.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>day06-整合阿里云oss和Excel导入分类 - TBlog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/prism/1.26.0/plugins/line-numbers/prism-line-numbers.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/myBlog/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/myBlog/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/myBlog/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"no-ten.github.io","root":"/myBlog/","version":"1.9.0","typing":{"enable":true,"typeSpeed":230,"cursorChar":"_","loop":true,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/myBlog/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/myBlog/js/utils.js" ></script>
  <script  src="/myBlog/js/color-schema.js" ></script>

  
<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/myBlog/atom.xml" title="TBlog" type="application/atom+xml">
</head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/myBlog/">
      <strong>TBlog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/myBlog/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/myBlog/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/myBlog/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/myBlog/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/myBlog/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/myBlog/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="day06-整合阿里云oss和Excel导入分类"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        Ten
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2021-12-24 11:00" pubdate>
          2021年12月24日上午11点00分 
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          25k 字
        
      </span>
    

    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">day06-整合阿里云oss和Excel导入分类</h1>
            
            <div class="markdown-body">
              
              <h1 id="day06-整合阿里云oss和Excel导入分类"><a href="#day06-整合阿里云oss和Excel导入分类" class="headerlink" title="day06-整合阿里云oss和Excel导入分类"></a>day06-整合阿里云oss和Excel导入分类</h1><h1 id="讲师管理-上传讲师头像后端接口"><a href="#讲师管理-上传讲师头像后端接口" class="headerlink" title="讲师管理-上传讲师头像后端接口"></a>讲师管理-上传讲师头像后端接口</h1><h2 id="后端环境搭建"><a href="#后端环境搭建" class="headerlink" title="后端环境搭建"></a>后端环境搭建</h2><h3 id="搭建阿里云OSS项目环境"><a href="#搭建阿里云OSS项目环境" class="headerlink" title="搭建阿里云OSS项目环境"></a>搭建阿里云OSS项目环境</h3><p>在service模块下创建子模块service_oss</p>
<p>配置pom.xml</p>
<div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml">&lt;dependencies&gt;

        &lt;!-- 阿里云oss依赖 --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.aliyun.oss&lt;&#x2F;groupId&gt;
            &lt;artifactId&gt;aliyun-sdk-oss&lt;&#x2F;artifactId&gt;
        &lt;&#x2F;dependency&gt;

        &lt;!-- 日期工具栏依赖 --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;joda-time&lt;&#x2F;groupId&gt;
            &lt;artifactId&gt;joda-time&lt;&#x2F;artifactId&gt;
        &lt;&#x2F;dependency&gt;

    &lt;&#x2F;dependencies&gt;</code></pre></div>

<p>配置application.properties</p>
<div class="code-wrapper"><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties">#服务端口
server.port&#x3D;8002

#服务名
spring.application.name&#x3D;service-oss

#环境设置：dev、test、prod
spring.profiles.active&#x3D;dev

#阿里云 OSS
#不同的服务器，地址不同
aliyun.oss.file.endpoint&#x3D;your endpoint
aliyun.oss.file.keyid&#x3D;your accessKeyId
aliyun.oss.file.keysecret&#x3D;your accessKeySecret
#bucket可以在控制台创建，也可以使用java代码创建
aliyun.oss.file.bucketname&#x3D;guli-file</code></pre></div>

<p>创建启动类，启动项目，发现报了一个需要配置数据库的问题</p>
<div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">***************************
APPLICATION FAILED TO START
***************************

Description:

Failed to configure a DataSource: &#39;url&#39; attribute is not specified and no embedded datasource could be configured.

Reason: Failed to determine a suitable driver class


Action:

Consider the following:
	If you want an embedded database (H2, HSQL or Derby), please put it on the classpath.
	If you have database settings to be loaded from a particular profile you may need to activate it (no profiles are currently active).
</code></pre></div>

<p>解决方案</p>
<p>一，在配置文件中加入数据库的配置（由于该模块只做上传功能，不需要加入）。</p>
<p>二，在启动类上加入@SpringBootApplication(exclude = DataSourceAutoConfiguration.class)这个便可，排除数据库自动装配的文件</p>
<h2 id="创建常量类"><a href="#创建常量类" class="headerlink" title="创建常量类"></a>创建常量类</h2><p>创建com.atguigu.oss.utils包，创建类ConstantPropertiesUtils</p>
<div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">&#x2F;&#x2F; 项目启动，spring接口，spring加载之后，执行接口一个方法
@Component
public class ConstantPropertiesUtils implements InitializingBean &#123;
    &#x2F;&#x2F; 读取配置文件内容
    @Value(&quot;$&#123;aliyun.oss.file.endpoint&#125;&quot;)
    private String endpoint;

    @Value(&quot;$&#123;aliyun.oss.file.keyid&#125;&quot;)
    private String keyId;

    @Value(&quot;$&#123;aliyun.oss.file.keysecret&#125;&quot;)
    private String keySecret;

    @Value(&quot;$&#123;aliyun.oss.file.bucketname&#125;&quot;)
    private String bucketName;

    public static String END_POINT;
    public static String ACCESS_KEY_ID;
    public static String ACCESS_KEY_SECRET;
    public static String BUCKET_NAME;

    @Override
    public void afterPropertiesSet() throws Exception &#123;
        END_POINT &#x3D; endpoint;
        ACCESS_KEY_ID &#x3D; keyId;
        ACCESS_KEY_SECRET &#x3D; keySecret;
        BUCKET_NAME &#x3D; bucketName;
    &#125;
&#125;
</code></pre></div>

<p>InitializingBean这个接口是为了让其他人可以调用里面定义的属性</p>
<h2 id="后端接口实现"><a href="#后端接口实现" class="headerlink" title="后端接口实现"></a>后端接口实现</h2><p>在com.atguigu.oss.controller创建OssController类</p>
<div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">@RestController
@RequestMapping(&quot;eduoss&#x2F;fileoss&quot;)
@CrossOrigin
@Api(description &#x3D; &quot;Oss文件上传&quot;)
public class OssController &#123;

    @Autowired
    private OssService ossService;

    &#x2F;&#x2F; 上传头像方法
    @ApiOperation(&quot;头像上传&quot;)
    @PostMapping
    public R uploadFile(@ApiParam(name &#x3D; &quot;file&quot;,value &#x3D; &quot;上传文件&quot;,required &#x3D; false) MultipartFile file)&#123;
        &#x2F;&#x2F; 获取上传文件，MultipartFile
        &#x2F;&#x2F; 返回上传文件的oss路径
        String url &#x3D; ossService.uploadFileAvatar(file);
        return R.ok().data(&quot;url&quot;,url);
    &#125;

&#125;
</code></pre></div>

<p>在com.atguigu.oss.service创建service接口</p>
<div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">public interface OssService &#123;
    &#x2F;&#x2F; 上传头像方法
    String uploadFileAvatar(MultipartFile file);
&#125;
</code></pre></div>

<p>在com.atguigu.oss.service.impl实现service接口</p>
<div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">@Service
public class OssServiceImpl implements OssService &#123;

    &#x2F;&#x2F; 上传头像方法
    @Override
    public String uploadFileAvatar(MultipartFile file) &#123;
        &#x2F;&#x2F; 工具类获取值
        String endpoint &#x3D; ConstantPropertiesUtils.END_POINT;
        String accessKeyId &#x3D; ConstantPropertiesUtils.ACCESS_KEY_ID;
        String accessKeySecret &#x3D; ConstantPropertiesUtils.ACCESS_KEY_SECRET;
        String bucketName &#x3D; ConstantPropertiesUtils.BUCKET_NAME;


        try &#123;
            &#x2F;&#x2F; 创建ossClient实例
            OSS ossClient &#x3D; new OSSClientBuilder().build(endpoint, accessKeyId, accessKeySecret);

            &#x2F;&#x2F; 上传文件流
            InputStream inputStream &#x3D; file.getInputStream();

            &#x2F;&#x2F; 获取文件名称
            String filename &#x3D; file.getOriginalFilename();

            &#x2F;&#x2F; 第一个参数：bucket名称
            &#x2F;&#x2F; 第二个参数：上传到oss文件路径和文件名称 &#x2F;aa&#x2F;bb&#x2F;1.jpg
            &#x2F;&#x2F; 第三个参数：上传文件流
            ossClient.putObject(bucketName, filename, inputStream);

            &#x2F;&#x2F; 关闭OSSClient。
            ossClient.shutdown();

            &#x2F;&#x2F; 返回url
            &#x2F;&#x2F; https:&#x2F;&#x2F;project-guli-oss.oss-cn-shenzhen.aliyuncs.com&#x2F;1.png
            String url &#x3D; &quot;https:&#x2F;&#x2F;&quot;+bucketName+&quot;.&quot;+endpoint+&quot;&#x2F;&quot;+filename;
            return url;

        &#125; catch (IOException e) &#123;
            e.printStackTrace();
            return null;
        &#125;
    &#125;
&#125;
</code></pre></div>



<p>利用swagger-ui进行测试。</p>
<h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><ol>
<li>多次上传相同名称文件，造成最后一次上传会把之前上传的文件覆盖</li>
<li>把文件进行分类管理</li>
</ol>
<p><strong>解决方案</strong></p>
<ol>
<li>在文件名称添加随机唯一值，让每个文件名不同</li>
<li>利用DateTime进行分类</li>
</ol>
<div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">@Service
public class OssServiceImpl implements OssService &#123;

    &#x2F;&#x2F; 上传头像方法
    @Override
    public String uploadFileAvatar(MultipartFile file) &#123;
        &#x2F;&#x2F; 工具类获取值
        String endpoint &#x3D; ConstantPropertiesUtils.END_POINT;
        String accessKeyId &#x3D; ConstantPropertiesUtils.ACCESS_KEY_ID;
        String accessKeySecret &#x3D; ConstantPropertiesUtils.ACCESS_KEY_SECRET;
        String bucketName &#x3D; ConstantPropertiesUtils.BUCKET_NAME;


        try &#123;
            &#x2F;&#x2F; 创建ossClient实例
            OSS ossClient &#x3D; new OSSClientBuilder().build(endpoint, accessKeyId, accessKeySecret);

            &#x2F;&#x2F; 上传文件流
            InputStream inputStream &#x3D; file.getInputStream();

            &#x2F;&#x2F; 获取文件名称
            String fileName &#x3D; file.getOriginalFilename();

            &#x2F;&#x2F; 1.在文件名里面添加随机唯一值
            String uuid &#x3D; UUID.randomUUID().toString().replaceAll(&quot;-&quot;, &quot;&quot;);
            &#x2F;&#x2F; 24g501.jpg
            fileName &#x3D; uuid+fileName;

            &#x2F;&#x2F; 2.将文件按照日期分类管理
            &#x2F;&#x2F; 2021&#x2F;1&#x2F;1
            String datePath &#x3D; new DateTime().toString(&quot;yyyy&#x2F;MM&#x2F;dd&quot;);
            &#x2F;&#x2F; 拼接
            &#x2F;&#x2F; 2021&#x2F;1&#x2F;1&#x2F;ge3201.jgp
            fileName &#x3D; datePath+&quot;&#x2F;&quot;+fileName;

            &#x2F;&#x2F; 第一个参数：bucket名称
            &#x2F;&#x2F; 第二个参数：上传到oss文件路径和文件名称 &#x2F;aa&#x2F;bb&#x2F;1.jpg
            &#x2F;&#x2F; 第三个参数：上传文件流
            ossClient.putObject(bucketName, fileName, inputStream);

            &#x2F;&#x2F; 关闭OSSClient。
            ossClient.shutdown();

            &#x2F;&#x2F; 返回url
            &#x2F;&#x2F; https:&#x2F;&#x2F;project-guli-oss.oss-cn-shenzhen.aliyuncs.com&#x2F;1.png
            String url &#x3D; &quot;https:&#x2F;&#x2F;&quot;+bucketName+&quot;.&quot;+endpoint+&quot;&#x2F;&quot;+fileName;
            return url;

        &#125; catch (IOException e) &#123;
            e.printStackTrace();
            return null;
        &#125;
    &#125;
&#125;</code></pre></div>



<h1 id="Nginx回顾"><a href="#Nginx回顾" class="headerlink" title="Nginx回顾"></a>Nginx回顾</h1><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p><img src="/myBlog/day06-%E6%95%B4%E5%90%88%E9%98%BF%E9%87%8C%E4%BA%91oss%E5%92%8CExcel%E5%AF%BC%E5%85%A5%E5%88%86%E7%B1%BB/07-nginx%E6%A6%82%E5%BF%B5%E5%9B%9E%E9%A1%BE.png" srcset="/myBlog/img/loading.gif" lazyload alt="07-nginx概念回顾"></p>
<p>下载Nginx压缩包，解压直接使用。使用方式，通过cmd启动，关闭Nginx利用命令Nginx程序名 -s stop</p>
<h2 id="Nginx配置"><a href="#Nginx配置" class="headerlink" title="Nginx配置"></a>Nginx配置</h2><p>修改Nginx端口，80改为81</p>
<div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">server &#123;
        listen       81;
        server_name  localhost;</code></pre></div>



<p>在http内加入以下转发规则</p>
<div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">server &#123;
		listen       9001;
		server_name  localhost;
	
		location ~ &#x2F;eduservice&#x2F; &#123;           
			proxy_pass http:&#x2F;&#x2F;localhost:8001;
		&#125;
	
		location ~ &#x2F;eduoss&#x2F; &#123;           
			proxy_pass http:&#x2F;&#x2F;localhost:8002;
		&#125;
&#125;</code></pre></div>

<p><img src="/myBlog/day06-%E6%95%B4%E5%90%88%E9%98%BF%E9%87%8C%E4%BA%91oss%E5%92%8CExcel%E5%AF%BC%E5%85%A5%E5%88%86%E7%B1%BB/image-20211224141522821.png" srcset="/myBlog/img/loading.gif" lazyload alt="image-20211224141522821"></p>
<p>最后再前端config/dev.env.js中的地址改成Nginx的地址，最后启动服务器测试，观察请求路径是否为Nginx配置的就可以。 </p>
<h1 id="讲师管理-上传讲师头像前端实现"><a href="#讲师管理-上传讲师头像前端实现" class="headerlink" title="讲师管理-上传讲师头像前端实现"></a>讲师管理-上传讲师头像前端实现</h1><h2 id="复制头像上传组件"><a href="#复制头像上传组件" class="headerlink" title="复制头像上传组件"></a>复制头像上传组件</h2><p><strong>从vue-element-admin复制组件：</strong></p>
<p>vue-element-admin/src/components/ImageCropper</p>
<p>vue-element-admin/src/components/PanThumb</p>
<h2 id="前端添加文件上传组件"><a href="#前端添加文件上传组件" class="headerlink" title="前端添加文件上传组件"></a>前端添加文件上传组件</h2><p><strong>src/views/edu/teacher/save.vue</strong></p>
<p>template：</p>
<div class="code-wrapper"><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">!-- 讲师头像：TODO --&gt;
       &lt;!-- 讲师头像 --&gt;
        &lt;el-form-item label&#x3D;&quot;讲师头像&quot;&gt;

            &lt;!-- 头衔缩略图 --&gt;
            &lt;pan-thumb :image&#x3D;&quot;teacher.avatar&quot;&#x2F;&gt;

            &lt;!-- 文件上传按钮 --&gt;
            &lt;el-button type&#x3D;&quot;primary&quot; icon&#x3D;&quot;el-icon-upload&quot; @click&#x3D;&quot;imagecropperShow&#x3D;true&quot;&gt;更换头像
            &lt;&#x2F;el-button&gt;
            &lt;!--
            v-show：是否显示上传组件
            :key：类似于id，如果一个页面多个图片上传控件，可以做区分
            :url：后台上传的url地址
            @close：关闭上传组件
            @crop-upload-success：上传成功后的回调 --&gt;
            &lt;image-cropper
                        v-show&#x3D;&quot;imagecropperShow&quot;
                        :width&#x3D;&quot;300&quot;
                        :height&#x3D;&quot;300&quot;
                        :key&#x3D;&quot;imagecropperKey&quot;
                        :url&#x3D;&quot;BASE_API+&#39;&#x2F;eduoss&#x2F;fileoss&#39;&quot;
                        field&#x3D;&quot;file&quot;
                        @close&#x3D;&quot;close&quot;
                        @crop-upload-success&#x3D;&quot;cropSuccess&quot;&#x2F;&gt;
        &lt;&#x2F;el-form-item&gt;</code></pre></div>

<p>引入组件模块</p>
<div class="code-wrapper"><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">import ImageCropper from &#39;@&#x2F;components&#x2F;ImageCropper&#39;
import PanThumb from &#39;@&#x2F;components&#x2F;PanThumb&#39;</code></pre></div>

<h2 id="设置默认头像"><a href="#设置默认头像" class="headerlink" title="设置默认头像"></a>设置默认头像</h2><p>config/dev.env.js中添加阿里云oss bucket地址</p>
<div class="code-wrapper"><pre class="line-numbers language-js" data-language="js"><code class="language-js">OSS_PATH: &#39;&quot;https:&#x2F;&#x2F;guli-file.oss-cn-beijing.aliyuncs.com&quot;&#39;</code></pre></div>

<p>组件中初始化头像默认地址</p>
<div class="code-wrapper"><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">const defaultForm &#x3D; &#123;
  ......,
  avatar: process.env.OSS_PATH + &#39;&#x2F;avatar&#x2F;default.jpg&#39;
&#125;</code></pre></div>

<h2 id="js脚本实现上传和图片回显"><a href="#js脚本实现上传和图片回显" class="headerlink" title="js脚本实现上传和图片回显"></a>js脚本实现上传和图片回显</h2><div class="code-wrapper"><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">export default &#123;
    components: &#123; ImageCropper, PanThumb &#125;,
    data()&#123;
        return&#123;
           ...
            BASE_API: process.env.BASE_API, &#x2F;&#x2F; 接口API地址
            imagecropperShow: false, &#x2F;&#x2F; 是否显示上传组件
            imagecropperKey: 0, &#x2F;&#x2F; 上传组件id
            saveBtnDisabled:false    &#x2F;&#x2F; 保存按钮是否禁止
        &#125;
    &#125;,
    ....
    methods:&#123;
        &#x2F;&#x2F; 上传成功饭的回调函数
        cropSuccess(data)&#123;
            this.imagecropperShow &#x3D; false
            this.teacher.avatar &#x3D; data.url
            &#x2F;&#x2F; 上传成功后，重新打开上传组件时初始化组件，否则显示上一次的上传结果
            this.imagecropperKey &#x3D; this.imagecropperKey + 1
        &#125;,

        &#x2F;&#x2F; 关闭上传组件
        close()&#123;
            this.imagecropperShow &#x3D; false
			&#x2F;&#x2F; 上传失败后，重新打开上传组件时初始化组件，否则显示上一次的上传结果
     		 this.imagecropperKey &#x3D; this.imagecropperKey + 1
        &#125;,

      ....

    &#125;
&#125;</code></pre></div>



<p>测试</p>
<h1 id="课程分类管理-添加课程分类后端"><a href="#课程分类管理-添加课程分类后端" class="headerlink" title="课程分类管理-添加课程分类后端"></a>课程分类管理-添加课程分类后端</h1><h2 id="EasyExcel写操作"><a href="#EasyExcel写操作" class="headerlink" title="EasyExcel写操作"></a>EasyExcel写操作</h2><p>出了下面这个，还需要poi依赖</p>
<div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml">&lt;dependencies&gt;
    &lt;!-- https:&#x2F;&#x2F;mvnrepository.com&#x2F;artifact&#x2F;com.alibaba&#x2F;easyexcel --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.alibaba&lt;&#x2F;groupId&gt;
        &lt;artifactId&gt;easyexcel&lt;&#x2F;artifactId&gt;
        &lt;version&gt;2.1.1&lt;&#x2F;version&gt;
    &lt;&#x2F;dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.poi&lt;&#x2F;groupId&gt;
        &lt;artifactId&gt;poi&lt;&#x2F;artifactId&gt;
        &lt;version&gt;3.17&lt;&#x2F;version&gt;
    &lt;&#x2F;dependency&gt;
&lt;&#x2F;dependencies&gt;</code></pre></div>

<p>编写实体类</p>
<div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">@Data
public class DemoData &#123;
	&#x2F;&#x2F; 设置Excel表头名称
    @ExcelProperty(&quot;学生编号&quot;)
    private int sno;

    @ExcelProperty(&quot;学生姓名&quot;)
    private String sname;

&#125;</code></pre></div>

<p>测试</p>
<div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">public class TestExcel &#123;

    public static void main(String[] args) &#123;
        String fileName &#x3D; &quot;E:\\1\\write.xlsx&quot;;
        &#x2F;&#x2F; 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭
        &#x2F;&#x2F; 如果这里想使用03 则 传入excelType参数即可
        EasyExcel.write(fileName,DemoData.class).sheet(&quot;学生信息&quot;).doWrite(getData());
    &#125;

    public static List&lt;DemoData&gt; getData()&#123;
        List&lt;DemoData&gt; list &#x3D; new ArrayList&lt;&gt;();
        for (int i &#x3D; 0; i &lt; 10; i++) &#123;
            DemoData demoData &#x3D; new DemoData();
            demoData.setSno(i);
            demoData.setSname(&quot;lucy&quot; + i);
            list.add(demoData);
        &#125;
        return list;
    &#125;

&#125;</code></pre></div>



<h2 id="EasyExcel读操作"><a href="#EasyExcel读操作" class="headerlink" title="EasyExcel读操作"></a>EasyExcel读操作</h2><p>编写实体类</p>
<div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">@Data
public class DemoData &#123;
    &#x2F;&#x2F; 设置Excel表头名称
    @ExcelProperty(value &#x3D; &quot;学生编号&quot;,index &#x3D; 0)
    private int sno;

    @ExcelProperty(value &#x3D; &quot;学生姓名&quot;,index &#x3D; 1)
    private String sname;

&#125;</code></pre></div>

<p>创建监听器</p>
<div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">&#x2F;&#x2F; 创建监听器
public class ExcelListener extends AnalysisEventListener&lt;DemoData&gt; &#123;

    &#x2F;&#x2F; 一行一行的读，不读表头
    @Override
    public void invoke(DemoData data, AnalysisContext analysisContext) &#123;
        System.out.println(&quot;****&quot; + data);
    &#125;

    &#x2F;&#x2F; 读表头
    public void invokeHeadMap(Map&lt;Integer, String&gt; headMap, AnalysisContext context) &#123;
        System.out.println(&quot;表头&quot; + headMap);
    &#125;

    &#x2F;&#x2F; 完成读后的操作
    @Override
    public void doAfterAllAnalysed(AnalysisContext analysisContext) &#123;

    &#125;
&#125;</code></pre></div>

<p>测试</p>
<div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">public static void main(String[] args) &#123;
    &#x2F;&#x2F; 写
    &#x2F;*String fileName &#x3D; &quot;E:\\1\\write.xlsx&quot;;
    &#x2F;&#x2F; 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭
    &#x2F;&#x2F; 如果这里想使用03 则 传入excelType参数即可
    EasyExcel.write(fileName,DemoData.class).sheet(&quot;学生信息&quot;).doWrite(getData());*&#x2F;

    &#x2F;&#x2F; 读Excel操作
    String fileName &#x3D; &quot;E:\\1\\write.xlsx&quot;;
    EasyExcel.read(fileName,DemoData.class,new ExcelListener()).sheet().doRead();
&#125;</code></pre></div>

<p>结果</p>
<div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">表头&#123;0&#x3D;学生编号, 1&#x3D;学生姓名&#125;
****DemoData(sno&#x3D;0, sname&#x3D;lucy0)
****DemoData(sno&#x3D;1, sname&#x3D;lucy1)
****DemoData(sno&#x3D;2, sname&#x3D;lucy2)
****DemoData(sno&#x3D;3, sname&#x3D;lucy3)
****DemoData(sno&#x3D;4, sname&#x3D;lucy4)
****DemoData(sno&#x3D;5, sname&#x3D;lucy5)
****DemoData(sno&#x3D;6, sname&#x3D;lucy6)
****DemoData(sno&#x3D;7, sname&#x3D;lucy7)
****DemoData(sno&#x3D;8, sname&#x3D;lucy8)
****DemoData(sno&#x3D;9, sname&#x3D;lucy9)</code></pre></div>



<h2 id="添加课程分类"><a href="#添加课程分类" class="headerlink" title="添加课程分类"></a>添加课程分类</h2><p>导入依赖，上面已经导入了，不需要再次导入</p>
<p>利用代码生成器生成代码</p>
<p>编写controller</p>
<div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">@RestController
@RequestMapping(&quot;&#x2F;eduservice&#x2F;subject&quot;)
@CrossOrigin
public class EduSubjectController &#123;

    @Autowired
    private EduSubjectService subjectService;

    &#x2F;&#x2F; 添加课程分类
    &#x2F;&#x2F; 获取上传的文件，把文件内容读取出来
    @PostMapping(&quot;addSubject&quot;)
    public R addSubject(MultipartFile file)&#123;
        &#x2F;&#x2F; 上传过来的Excel文件
        subjectService.saveSubject(file, subjectService);
        return R.ok();
    &#125;

&#125;</code></pre></div>

<p>编写service接口</p>
<div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">public interface EduSubjectService extends IService&lt;EduSubject&gt; &#123;

    &#x2F;&#x2F; 添加课程分类
    void saveSubject(MultipartFile file,EduSubjectService subjectService);
&#125;</code></pre></div>

<p>编写service实现类</p>
<div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">@Service
public class EduSubjectServiceImpl extends ServiceImpl&lt;EduSubjectMapper, EduSubject&gt; implements EduSubjectService &#123;

    &#x2F;&#x2F; 添加课程分类
    @Override
    public void saveSubject(MultipartFile file,EduSubjectService subjectService) &#123;
        try &#123;
            &#x2F;&#x2F; 文件输入流
            InputStream in &#x3D; file.getInputStream();
            &#x2F;&#x2F; 调用方法进行读取
            EasyExcel.read(in, SubjectData.class,new SubjectExcelListener(subjectService)).sheet().doRead();
        &#125; catch (IOException e) &#123;
            e.printStackTrace();
        &#125;

    &#125;
&#125;</code></pre></div>

<p>在com.atguigu.eduservice.entity.excel中编写表格的属性实体类</p>
<div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">@Data
public class SubjectData &#123;

    @ExcelProperty(index &#x3D; 0)
    private String oneSubjectName;
    @ExcelProperty(index &#x3D; 1)
    private String twoSubjectName;

&#125;</code></pre></div>

<p>在com.atguigu.eduservice.listener编写监听类</p>
<div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">public class SubjectExcelListener extends AnalysisEventListener&lt;SubjectData&gt; &#123;

    &#x2F;&#x2F; 因为SubjectExcelListener不能交给spring管理，需要自己new，不能注入其他对象
    &#x2F;&#x2F; 不能实现数据的操作
    public EduSubjectService subjectService;

    public SubjectExcelListener() &#123;
    &#125;
    public SubjectExcelListener(EduSubjectService subjectService) &#123;
        this.subjectService &#x3D; subjectService;
    &#125;

    &#x2F;&#x2F; 一行一行读取
    @Override
    public void invoke(SubjectData subjectData, AnalysisContext analysisContext) &#123;
        if (subjectData &#x3D;&#x3D; null)&#123;
            throw new GuliException(20001,&quot;文件数据为空&quot;);
        &#125;

        &#x2F;&#x2F; 一行一行读取，每次读取有两个值，第一个值一级分类，第二值二级分类
        &#x2F;&#x2F; 判断一级分类是否重复
        EduSubject exitOneSubject &#x3D; this.exitOneSubject(subjectService, subjectData.getOneSubjectName());
        if (exitOneSubject &#x3D;&#x3D; null)&#123;    &#x2F;&#x2F; 说明不存在相同的一级分类，可以添加
            exitOneSubject &#x3D; new EduSubject();
            exitOneSubject.setParentId(&quot;0&quot;);
            exitOneSubject.setTitle(subjectData.getOneSubjectName());
            subjectService.save(exitOneSubject);
        &#125;

        &#x2F;&#x2F; 获取一级分类id
        String pid &#x3D; exitOneSubject.getId();

        &#x2F;&#x2F; 判断二级分类是否重复
        EduSubject exitTwoSubject &#x3D; this.exitTwoSubject(subjectService, subjectData.getOneSubjectName(),pid);
        if (exitTwoSubject &#x3D;&#x3D; null)&#123;    &#x2F;&#x2F; 说明不存在相同的一级分类，可以添加
            exitTwoSubject &#x3D; new EduSubject();
            exitTwoSubject.setParentId(pid);
            exitTwoSubject.setTitle(subjectData.getTwoSubjectName());
            subjectService.save(exitTwoSubject);
        &#125;

    &#125;

    &#x2F;&#x2F; 判断一级分类不能重复添加
    private EduSubject exitOneSubject(EduSubjectService subjectService,String name)&#123;
        QueryWrapper&lt;EduSubject&gt; wrapper &#x3D; new QueryWrapper&lt;&gt;();
        wrapper.eq(&quot;title&quot;,name);
        wrapper.eq(&quot;parent_id&quot;,&quot;0&quot;);
        EduSubject oneSubject &#x3D; subjectService.getOne(wrapper);
        return oneSubject;
    &#125;

    &#x2F;&#x2F; 判断二级分类不能重复添加
    private EduSubject exitTwoSubject(EduSubjectService subjectService,String name,String pid)&#123;
        QueryWrapper&lt;EduSubject&gt; wrapper &#x3D; new QueryWrapper&lt;&gt;();
        wrapper.eq(&quot;title&quot;,name);
        wrapper.eq(&quot;parent_id&quot;,pid);
        EduSubject twoSubject &#x3D; subjectService.getOne(wrapper);
        return twoSubject;
    &#125;


    @Override
    public void doAfterAllAnalysed(AnalysisContext analysisContext) &#123;

    &#125;
&#125;</code></pre></div>

<p>利用swagger测试。</p>
<h1 id="课程分类管理-添加课程分类前端"><a href="#课程分类管理-添加课程分类前端" class="headerlink" title="课程分类管理-添加课程分类前端"></a>课程分类管理-添加课程分类前端</h1><h2 id="添加路由"><a href="#添加路由" class="headerlink" title="添加路由"></a>添加路由</h2><p>vue-admin-template-master\src\router\index.js</p>
<div class="code-wrapper"><pre class="line-numbers language-js" data-language="js"><code class="language-js">&#123;
    path: &#39;&#x2F;subject&#39;,
    component: Layout,
    redirect: &#39;&#x2F;subject&#x2F;list&#39;,
    name: &#39;课程分类管理&#39;,
    meta: &#123; title: &#39;课程分类管理&#39;, icon: &#39;example&#39; &#125;,
    children: [
      &#123;
        path: &#39;list&#39;,
        name: &#39;课程列表&#39;,
        component: () &#x3D;&gt; import(&#39;@&#x2F;views&#x2F;edu&#x2F;subject&#x2F;list&#39;),
        meta: &#123; title: &#39;课程列表&#39;, icon: &#39;table&#39; &#125;
      &#125;,
      &#123;
        path: &#39;save&#39;,
        name: &#39;添加课程分类&#39;,
        component: () &#x3D;&gt; import(&#39;@&#x2F;views&#x2F;edu&#x2F;subject&#x2F;save&#39;),
        meta: &#123; title: &#39;添加课程分类&#39;, icon: &#39;tree&#39; &#125;
      &#125;
    ]
  &#125;,</code></pre></div>

<h2 id="添加vue组件"><a href="#添加vue组件" class="headerlink" title="添加vue组件"></a>添加vue组件</h2><p>list.vue和save.vue</p>
<h2 id="template"><a href="#template" class="headerlink" title="template"></a>template</h2><div class="code-wrapper"><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;template&gt;
   &lt;div class&#x3D;&quot;app-container&quot;&gt;
     &lt;el-form label-width&#x3D;&quot;120px&quot;&gt;
       &lt;el-form-item label&#x3D;&quot;信息描述&quot;&gt;
         &lt;el-tag type&#x3D;&quot;info&quot;&gt;excel模版说明&lt;&#x2F;el-tag&gt;
         &lt;el-tag&gt;
           &lt;i class&#x3D;&quot;el-icon- &quot;&#x2F;&gt;
           &lt;a :href&#x3D;&quot;&#39;&#x2F;static&#x2F;01.xlsx&#39;&quot;&gt;点击下载模版&lt;&#x2F;a&gt;
         &lt;&#x2F;el-tag&gt;
       &lt;&#x2F;el-form-item&gt;
       &lt;el-form-item label&#x3D;&quot;选择Excel&quot;&gt;
         &lt;el-upload
           ref&#x3D;&quot;upload&quot;
           :auto-upload&#x3D;&quot;false&quot;
           :on-success&#x3D;&quot;fileUploadSuccess&quot;
           :on-error&#x3D;&quot;fileUploadError&quot;
           :disabled&#x3D;&quot;importBtnDisabled&quot;
           :limit&#x3D;&quot;1&quot;
           :action&#x3D;&quot;BASE_API+&#39;&#x2F;eduservice&#x2F;subject&#x2F;addSubject&#39;&quot;
           name&#x3D;&quot;file&quot;
           accept&#x3D;&quot;application&#x2F;vnd.ms-excel&quot;&gt;
           &lt;el-button slot&#x3D;&quot;trigger&quot; size&#x3D;&quot;small&quot; type&#x3D;&quot;primary&quot;&gt;选取文件&lt;&#x2F;el-button&gt;
           &lt;el-button
             :loading&#x3D;&quot;loading&quot;
             style&#x3D;&quot;margin-left: 10px;&quot;
             size&#x3D;&quot;small&quot;
             type&#x3D;&quot;success&quot;
             @click&#x3D;&quot;submitUpload&quot;&gt;上传到服务器&lt;&#x2F;el-button&gt;
         &lt;&#x2F;el-upload&gt;
       &lt;&#x2F;el-form-item&gt;
     &lt;&#x2F;el-form&gt;
   &lt;&#x2F;div&gt;
 &lt;&#x2F;template&gt;</code></pre></div>

<h2 id="js定义数据"><a href="#js定义数据" class="headerlink" title="js定义数据"></a>js定义数据</h2><div class="code-wrapper"><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;script&gt;
 export default &#123;
     data()&#123;

         return&#123;
            BASE_API: process.env.BASE_API,     &#x2F;&#x2F; 接口API地址
            importBtnDisabled: false,           &#x2F;&#x2F; 按钮是否禁用,
            loading: false
         &#125;

     &#125;,
     created()&#123;

     &#125;,
     methods:&#123;
         &#x2F;&#x2F; 上传到服务器
         submitUpload()&#123;
           
         &#125;,
         &#x2F;&#x2F; 上传成功
         fileUploadSuccess()&#123;
           
         &#125;,

         &#x2F;&#x2F; 上传失败
         fileUploadError()&#123;
         
         &#125;
     &#125;
 &#125;
 &lt;&#x2F;script&gt;</code></pre></div>

<h2 id="js上传方法"><a href="#js上传方法" class="headerlink" title="js上传方法"></a>js上传方法</h2><div class="code-wrapper"><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&#x2F;&#x2F; 上传到服务器
submitUpload()&#123;
    this.fileUploadBtnText &#x3D; &#39;正在上传&#39;
    this.importBtnDisabled &#x3D; true
    this.loading &#x3D; true
    this.$refs.upload.submit()
&#125;,</code></pre></div>

<h2 id="回调函数"><a href="#回调函数" class="headerlink" title="回调函数"></a>回调函数</h2><div class="code-wrapper"><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&#x2F;&#x2F; 上传成功
fileUploadSuccess()&#123;
    this.loading &#x3D; false
    this.$message(&#123;
        type: &#39;success&#39;,
        message: &#39;添加课程分类成功&#39;
	&#125;)
&#x2F;&#x2F; 跳转到课程分类列表
&#125;,

&#x2F;&#x2F; 上传失败
fileUploadError()&#123;
    this.loading &#x3D; false
    this.$message(&#123;
        type: &#39;error&#39;,
        message: &#39;添加课程分类失败&#39;
    &#125;)
&#125;</code></pre></div>

<p>save.vue完整代码</p>
<div class="code-wrapper"><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;template&gt;
   &lt;div class&#x3D;&quot;app-container&quot;&gt;
     &lt;el-form label-width&#x3D;&quot;120px&quot;&gt;
       &lt;el-form-item label&#x3D;&quot;信息描述&quot;&gt;
         &lt;el-tag type&#x3D;&quot;info&quot;&gt;excel模版说明&lt;&#x2F;el-tag&gt;
         &lt;el-tag&gt;
           &lt;i class&#x3D;&quot;el-icon- &quot;&#x2F;&gt;
           &lt;a :href&#x3D;&quot;&#39;&#x2F;static&#x2F;01.xlsx&#39;&quot;&gt;点击下载模版&lt;&#x2F;a&gt;
         &lt;&#x2F;el-tag&gt;
       &lt;&#x2F;el-form-item&gt;
       &lt;el-form-item label&#x3D;&quot;选择Excel&quot;&gt;
         &lt;el-upload
           ref&#x3D;&quot;upload&quot;
           :auto-upload&#x3D;&quot;false&quot;
           :on-success&#x3D;&quot;fileUploadSuccess&quot;
           :on-error&#x3D;&quot;fileUploadError&quot;
           :disabled&#x3D;&quot;importBtnDisabled&quot;
           :limit&#x3D;&quot;1&quot;
           :action&#x3D;&quot;BASE_API+&#39;&#x2F;eduservice&#x2F;subject&#x2F;addSubject&#39;&quot;
           name&#x3D;&quot;file&quot;
           accept&#x3D;&quot;application&#x2F;vnd.ms-excel&quot;&gt;
           &lt;el-button slot&#x3D;&quot;trigger&quot; size&#x3D;&quot;small&quot; type&#x3D;&quot;primary&quot;&gt;选取文件&lt;&#x2F;el-button&gt;
           &lt;el-button
             :loading&#x3D;&quot;loading&quot;
             style&#x3D;&quot;margin-left: 10px;&quot;
             size&#x3D;&quot;small&quot;
             type&#x3D;&quot;success&quot;
             @click&#x3D;&quot;submitUpload&quot;&gt;上传到服务器&lt;&#x2F;el-button&gt;
         &lt;&#x2F;el-upload&gt;
       &lt;&#x2F;el-form-item&gt;
     &lt;&#x2F;el-form&gt;
   &lt;&#x2F;div&gt;
 &lt;&#x2F;template&gt;

 &lt;script&gt;
 export default &#123;
     data()&#123;

         return&#123;
            BASE_API: process.env.BASE_API,     &#x2F;&#x2F; 接口API地址
            importBtnDisabled: false,           &#x2F;&#x2F; 按钮是否禁用,
            loading: false
         &#125;

     &#125;,
     created()&#123;

     &#125;,
     methods:&#123;
         &#x2F;&#x2F; 上传到服务器
         submitUpload()&#123;
            this.fileUploadBtnText &#x3D; &#39;正在上传&#39;
            this.importBtnDisabled &#x3D; true
            this.loading &#x3D; true
            this.$refs.upload.submit()
         &#125;,
         &#x2F;&#x2F; 上传成功
         fileUploadSuccess()&#123;
            this.loading &#x3D; false
            this.$message(&#123;
            type: &#39;success&#39;,
                message: &#39;添加课程分类成功&#39;
            &#125;)
            &#x2F;&#x2F; 跳转到课程分类列表，路由转发
            this.$router.push(&#123;path:&#39;&#x2F;subject&#x2F;list&#39;&#125;)
         &#125;,

         &#x2F;&#x2F; 上传失败
         fileUploadError()&#123;
            this.loading &#x3D; false
            this.$message(&#123;
                type: &#39;error&#39;,
                message: &#39;添加课程分类失败&#39;
            &#125;)
         &#125;

     &#125;
 &#125;
 &lt;&#x2F;script&gt;</code></pre></div>





<h1 id="课程分类管理-课程分类显示接口"><a href="#课程分类管理-课程分类显示接口" class="headerlink" title="课程分类管理-课程分类显示接口"></a>课程分类管理-课程分类显示接口</h1><p>树形结构，框架需要的返回数据，进行接口的编写</p>
<h2 id="实体类"><a href="#实体类" class="headerlink" title="实体类"></a>实体类</h2><p>在com.atguigu.eduservice.entity.subject下创建对应的实体类</p>
<p>一级分类</p>
<div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">&#x2F;&#x2F; 一级分类
@Data
public class OneSubject &#123;
    private String id;
    private String title;
    &#x2F;&#x2F; 存放二级分类
    List&lt;TwoSubject&gt; children &#x3D; new ArrayList&lt;&gt;();

&#125;</code></pre></div>

<p>二级分类</p>
<div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">&#x2F;&#x2F; 二级分类
@Data
public class TwoSubject &#123;
    private String id;
    private String title;
&#125;</code></pre></div>

<h2 id="controller"><a href="#controller" class="headerlink" title="controller"></a>controller</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">@RestController
@RequestMapping(&quot;&#x2F;eduservice&#x2F;subject&quot;)
@CrossOrigin
public class EduSubjectController &#123;

    @Autowired
    private EduSubjectService subjectService;

	....

    &#x2F;&#x2F; 查看所有课程分类（树形结构）
    @GetMapping(&quot;findAllSubject&quot;)
    public R findAllSubject()&#123;
        List&lt;OneSubject&gt; allSubjectList &#x3D; subjectService.findOneTwoSubject();
        return R.ok().data(&quot;allSubjectList&quot;,allSubjectList);
    &#125;

&#125;</code></pre></div>

<h2 id="service接口"><a href="#service接口" class="headerlink" title="service接口"></a>service接口</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">public interface EduSubjectService extends IService&lt;EduSubject&gt; &#123;

    ....
        
    &#x2F;&#x2F; 查看所有课程分类（树形结构）
    List&lt;OneSubject&gt; findOneTwoSubject();
&#125;</code></pre></div>

<h2 id="serviceImpl实现类"><a href="#serviceImpl实现类" class="headerlink" title="serviceImpl实现类"></a>serviceImpl实现类</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">@Service
public class EduSubjectServiceImpl extends ServiceImpl&lt;EduSubjectMapper, EduSubject&gt; implements EduSubjectService &#123;

		....
            
    &#x2F;&#x2F; 查看所有课程分类（树形结构）
    @Override
    public List&lt;OneSubject&gt; findOneTwoSubject() &#123;
        &#x2F;&#x2F; 一级分类的parent_id为0，二级的不为0
        &#x2F;&#x2F; 1.查询所有一级分类
        QueryWrapper&lt;EduSubject&gt; oneSubjectWrapper &#x3D; new QueryWrapper&lt;&gt;();
        oneSubjectWrapper.eq(&quot;parent_id&quot;,&quot;0&quot;);

        &#x2F;&#x2F; 调用BaseMapper查询数据库
        List&lt;EduSubject&gt; oneSubjectsList &#x3D; baseMapper.selectList(oneSubjectWrapper);

        &#x2F;&#x2F; 2.查询所有二级分类
        QueryWrapper&lt;EduSubject&gt; twoSubjectWrapper &#x3D; new QueryWrapper&lt;&gt;();
        twoSubjectWrapper.ne(&quot;parent_id&quot;,&quot;0&quot;);
        List&lt;EduSubject&gt; twoSubjectsList &#x3D; baseMapper.selectList(twoSubjectWrapper);

        &#x2F;&#x2F; 创建一个最终返回的list集合
        List&lt;OneSubject&gt; finalSubjectList &#x3D; new ArrayList&lt;&gt;();

        &#x2F;&#x2F; 3.封装一级分类
        for (int i &#x3D; 0; i &lt; oneSubjectsList.size(); i++)&#123;
            &#x2F;&#x2F; 先从集合中得到一个EduSubject对象
            EduSubject eduSubject &#x3D; oneSubjectsList.get(i);

            &#x2F;&#x2F; 创建一个OneSubject对象，将从集合中取出的值加入进去oneSubject
            OneSubject oneSubject &#x3D; new OneSubject();

            &#x2F;&#x2F; 第一种写法
            &#x2F;&#x2F;oneSubject.setId(eduSubject.getId());
            &#x2F;&#x2F;oneSubject.setTitle(eduSubject.getTitle());

            &#x2F;&#x2F; 第二种写法，利用工具类，将eduSubject的值赋给oneSubject，效果和上面的一样
            BeanUtils.copyProperties(eduSubject,oneSubject);

            &#x2F;&#x2F; 将oneSubject加入到最终的集合finalSubjectList
            finalSubjectList.add(oneSubject);

            &#x2F;&#x2F; 4.封装二级分类
            &#x2F;&#x2F; 先创建一个集合保存二级分类
            List&lt;TwoSubject&gt; finalTwoSubjectList &#x3D; new ArrayList&lt;&gt;();

            &#x2F;&#x2F; 遍历twoSubjectsList，拿到数据
            for (int m &#x3D; 0; m &lt; twoSubjectsList.size(); m++) &#123;
                &#x2F;&#x2F; 从遍历twoSubjectsList中取一个EduSubject对象
                EduSubject tSubject &#x3D; twoSubjectsList.get(m);

                &#x2F;&#x2F; 创建一个twoSubject，方便从twoSubjectsList取出来的tSubject加入
                TwoSubject twoSubject &#x3D; new TwoSubject();

                &#x2F;&#x2F; 判断是否需要该一级分类的
                if (tSubject.getParentId().equals(eduSubject.getId()))&#123;
                    &#x2F;&#x2F; 如果二级分类的ParentId等于一级分类的id就说明是同一分类的，则将tSubject赋值给twoSubject
                    BeanUtils.copyProperties(tSubject,twoSubject);

                    &#x2F;&#x2F; 将赋值后的twoSubject加入到finalTwoSubjectList中
                    finalTwoSubjectList.add(twoSubject);
                &#125;
            &#125;
            &#x2F;&#x2F; 当这个for循环结束后，将二级分类集合加入到当前一级分类
            oneSubject.setChildren(finalTwoSubjectList);
        &#125;

        return finalSubjectList;
    &#125;
&#125;</code></pre></div>

<p>测试</p>
<h1 id="课程分类管理-课程分类显示前端"><a href="#课程分类管理-课程分类显示前端" class="headerlink" title="课程分类管理-课程分类显示前端"></a>课程分类管理-课程分类显示前端</h1><p>在vue-admin-template-master\src\api\edu\subject.js，添加方法</p>
<div class="code-wrapper"><pre class="line-numbers language-js" data-language="js"><code class="language-js">export default&#123;
    &#x2F;&#x2F; 查询课程分类列表
    getSubjectList()&#123;
        return request(&#123;
            url: &#96;&#x2F;eduservice&#x2F;subject&#x2F;findAllSubject&#96;,
            method: &#39;get&#39;
          &#125;)
    &#125;
   
&#125;
</code></pre></div>

<p>在vue-admin-template-master\src\views\edu\subject\list.vue将data2的值置空</p>
<div class="code-wrapper"><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">data() &#123;
  return &#123;
    filterText: &#39;&#39;,
    data2: [],
    defaultProps: &#123;
      children: &#39;children&#39;,
      label: &#39;title&#39;
    &#125;
  &#125;
&#125;s</code></pre></div>

<p>导入方法</p>
<div class="code-wrapper"><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">import subject from &#39;@&#x2F;api&#x2F;edu&#x2F;subject&#39;</code></pre></div>

<p>调用方法</p>
<div class="code-wrapper"><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue"> created()&#123;
    &#x2F;&#x2F; 调用查询课程分类的方法
    this.getAllSubject()
  &#125;,
...

  methods: &#123;
    &#x2F;&#x2F; 查询课程分类列表
    getAllSubject()&#123;
        subject.getSubjectList()
        .then(response &#x3D;&gt;&#123;
            this.data2 &#x3D; response.data.list
        &#125;)
    &#125;,</code></pre></div>

<p>检索功能优化，优化区分大小写，优化后不区分大小写</p>
<div class="code-wrapper"><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">filterNode(value, data) &#123;
      if (!value) return true
      return data.title.toLowerCase().indexOf(value.toLowerCase()) !&#x3D;&#x3D; -1
    &#125;</code></pre></div>



<p>list.vue完整代码</p>
<div class="code-wrapper"><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;template&gt;
  &lt;div class&#x3D;&quot;app-container&quot;&gt;
    &lt;el-input v-model&#x3D;&quot;filterText&quot; placeholder&#x3D;&quot;Filter keyword&quot; style&#x3D;&quot;margin-bottom:30px;&quot; &#x2F;&gt;

    &lt;el-tree
      ref&#x3D;&quot;tree2&quot;
      :data&#x3D;&quot;data2&quot;
      :props&#x3D;&quot;defaultProps&quot;
      :filter-node-method&#x3D;&quot;filterNode&quot;
      class&#x3D;&quot;filter-tree&quot;
      default-expand-all
    &#x2F;&gt;

  &lt;&#x2F;div&gt;
&lt;&#x2F;template&gt;

&lt;script&gt;

import subject from &#39;@&#x2F;api&#x2F;edu&#x2F;subject&#39;

export default &#123;

  data() &#123;
    return &#123;
      filterText: &#39;&#39;,
      data2: [],
      defaultProps: &#123;
        children: &#39;children&#39;,
        label: &#39;title&#39;
      &#125;
    &#125;
  &#125;,
  created()&#123;
    &#x2F;&#x2F; 调用查询课程分类的方法
    this.getAllSubject()
  &#125;,
  watch: &#123;
    filterText(val) &#123;
      this.$refs.tree2.filter(val)
    &#125;
  &#125;,

  methods: &#123;
    &#x2F;&#x2F; 查询课程分类列表
    getAllSubject()&#123;
        subject.getSubjectList()
        .then(response &#x3D;&gt;&#123;
            this.data2 &#x3D; response.data.list
        &#125;)
    &#125;,

    filterNode(value, data) &#123;
      if (!value) return true
      return data.title.toLowerCase().indexOf(value.toLowerCase()) !&#x3D;&#x3D; -1
    &#125;
  &#125;
&#125;
&lt;&#x2F;script&gt;

</code></pre></div>


              
            </div>
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/myBlog/categories/%E9%A1%B9%E7%9B%AE-%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2-%E7%AC%94%E8%AE%B0/" class="category-chain-item">项目|谷粒学院|笔记</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/myBlog/tags/project/">#project</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>day06-整合阿里云oss和Excel导入分类</div>
      <div>https://no-ten.github.io/day06-整合阿里云oss和Excel导入分类/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Ten</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2021年12月24日</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>许可协议</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - 署名">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/myBlog/day07-%E8%AF%BE%E7%A8%8B%E5%8F%91%E5%B8%83-%E6%B7%BB%E5%8A%A0%E8%AF%BE%E7%A8%8B%E4%BF%A1%E6%81%AF/" title="day07-课程发布-添加课程信息">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">day07-课程发布-添加课程信息</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/myBlog/day05-%E8%AE%B2%E5%B8%88%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" title="day05-讲师管理模块前端开发">
                        <span class="hidden-mobile">day05-讲师管理模块前端开发</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  






    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    
  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/myBlog/js/events.js" ></script>
<script  src="/myBlog/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>






  
    <script  src="/myBlog/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.0/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script  src="https://lib.baomitu.com/prism/1.26.0/components/prism-core.min.js" ></script>

  <script  src="https://lib.baomitu.com/prism/1.26.0/plugins/autoloader/prism-autoloader.min.js" ></script>

  <script  src="https://lib.baomitu.com/prism/1.26.0/plugins/line-numbers/prism-line-numbers.min.js" ></script>

  <script>
  (function() {
    var enableLang = CONFIG.code_language.enable && CONFIG.code_language.default;
    var enableCopy = CONFIG.copy_btn;
    if (!enableLang && !enableCopy) {
      return;
    }

    function getBgClass(ele) {
      return Fluid.utils.getBackgroundLightness(ele) >= 0 ? 'code-widget-light' : 'code-widget-dark';
    }

    var copyTmpl = '';
    copyTmpl += '<div class="code-widget">';
    copyTmpl += 'LANG';
    copyTmpl += '</div>';
    jQuery('.markdown-body pre').each(function() {
      var $pre = jQuery(this);
      if ($pre.find('code.mermaid').length > 0) {
        return;
      }
      if ($pre.find('span.line').length > 0) {
        return;
      }

      var lang = '';

      if (enableLang) {
        lang = CONFIG.code_language.default;
        if ($pre[0].children.length > 0 && $pre[0].children[0].classList.length >= 2 && $pre.children().hasClass('hljs')) {
          lang = $pre[0].children[0].classList[1];
        } else if ($pre[0].getAttribute('data-language')) {
          lang = $pre[0].getAttribute('data-language');
        } else if ($pre.parent().hasClass('sourceCode') && $pre[0].children.length > 0 && $pre[0].children[0].classList.length >= 2) {
          lang = $pre[0].children[0].classList[1];
          $pre.parent().addClass('code-wrapper');
        } else if ($pre.parent().hasClass('markdown-body') && $pre[0].classList.length === 0) {
          $pre.wrap('<div class="code-wrapper"></div>');
        }
        lang = lang.toUpperCase().replace('NONE', CONFIG.code_language.default);
      }
      $pre.append(copyTmpl.replace('LANG', lang).replace('code-widget">',
        getBgClass($pre[0]) + (enableCopy ? ' code-widget copy-btn" data-clipboard-snippet><i class="iconfont icon-copy"></i>' : ' code-widget">')));

      if (enableCopy) {
        Fluid.utils.createScript('https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js', function() {
          var clipboard = new window.ClipboardJS('.copy-btn', {
            target: function(trigger) {
              var nodes = trigger.parentNode.childNodes;
              for (var i = 0; i < nodes.length; i++) {
                if (nodes[i].tagName === 'CODE') {
                  return nodes[i];
                }
              }
            }
          });
          clipboard.on('success', function(e) {
            e.clearSelection();
            e.trigger.innerHTML = e.trigger.innerHTML.replace('icon-copy', 'icon-success');
            setTimeout(function() {
              e.trigger.innerHTML = e.trigger.innerHTML.replace('icon-success', 'icon-copy');
            }, 2000);
          });
        });
      }
    });
  })();
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/myBlog/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/myBlog/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
